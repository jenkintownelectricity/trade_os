{
  "_lds": {
    "uuid": "tradeos-shell-2026-001",
    "type": "ui_component",
    "version": "1.0.0",
    "created": "2026-01-13T22:55:00Z",
    "parent": "tradeos-master-2026-001",
    "phase": 1,
    "sequence": 3
  },
  "core": {
    "name": "TradeOS App Shell",
    "description": "Stateless UI shell. Navigation, layout, entity loader. Intelligence lives in entities, not here.",
    "principle": "Thin shell - buttons, forms, display only. All logic delegated to kernel."
  },
  "navigation": {
    "admin": [
      { "id": "dashboard", "label": "Dashboard", "icon": "LayoutDashboard", "path": "/" },
      { "id": "schedule", "label": "Schedule", "icon": "Calendar", "path": "/schedule" },
      { "id": "dispatch", "label": "Dispatch", "icon": "Truck", "path": "/dispatch" },
      { "id": "jobs", "label": "Jobs", "icon": "Briefcase", "path": "/jobs" },
      { "id": "customers", "label": "Customers", "icon": "Users", "path": "/customers" },
      { "id": "quotes", "label": "Quotes", "icon": "FileText", "path": "/quotes" },
      { "id": "invoices", "label": "Invoices", "icon": "Receipt", "path": "/invoices" },
      { "id": "reports", "label": "Reports", "icon": "BarChart3", "path": "/reports" },
      { "id": "team", "label": "Team", "icon": "UserCog", "path": "/team" },
      { "id": "settings", "label": "Settings", "icon": "Settings", "path": "/settings" }
    ],
    "office": [
      { "id": "dashboard", "label": "Dashboard", "icon": "LayoutDashboard", "path": "/" },
      { "id": "schedule", "label": "Schedule", "icon": "Calendar", "path": "/schedule" },
      { "id": "dispatch", "label": "Dispatch", "icon": "Truck", "path": "/dispatch" },
      { "id": "jobs", "label": "Jobs", "icon": "Briefcase", "path": "/jobs" },
      { "id": "customers", "label": "Customers", "icon": "Users", "path": "/customers" },
      { "id": "quotes", "label": "Quotes", "icon": "FileText", "path": "/quotes" },
      { "id": "invoices", "label": "Invoices", "icon": "Receipt", "path": "/invoices" },
      { "id": "reports", "label": "Reports", "icon": "BarChart3", "path": "/reports" }
    ],
    "field_tech": [
      { "id": "my_day", "label": "My Day", "icon": "Calendar", "path": "/" },
      { "id": "current_job", "label": "Current Job", "icon": "Briefcase", "path": "/job" },
      { "id": "time", "label": "Time", "icon": "Clock", "path": "/time" }
    ],
    "customer": [
      { "id": "home", "label": "Home", "icon": "Home", "path": "/" },
      { "id": "appointments", "label": "Appointments", "icon": "Calendar", "path": "/appointments" },
      { "id": "quotes", "label": "Quotes", "icon": "FileText", "path": "/quotes" },
      { "id": "invoices", "label": "Invoices", "icon": "Receipt", "path": "/invoices" },
      { "id": "messages", "label": "Messages", "icon": "MessageSquare", "path": "/messages" }
    ]
  },
  "react_component": {
    "filename": "AppShell.tsx",
    "code": "import React, { useState, useCallback } from 'react';\nimport { \n  LayoutDashboard, Calendar, Truck, Briefcase, Users, FileText,\n  Receipt, BarChart3, UserCog, Settings, Home, MessageSquare,\n  Clock, Menu, X, Bell, User, ChevronDown, LogOut, Shield\n} from 'lucide-react';\nimport { useKernel, Role, ValidationResponse } from './LDSKernel';\n\nconst iconMap: Record<string, React.FC<{ className?: string }>> = {\n  LayoutDashboard, Calendar, Truck, Briefcase, Users, FileText,\n  Receipt, BarChart3, UserCog, Settings, Home, MessageSquare, Clock\n};\n\ninterface NavItem {\n  id: string;\n  label: string;\n  icon: string;\n  path: string;\n}\n\nconst navigation: Record<Role, NavItem[]> = {\n  admin: [\n    { id: 'dashboard', label: 'Dashboard', icon: 'LayoutDashboard', path: '/' },\n    { id: 'schedule', label: 'Schedule', icon: 'Calendar', path: '/schedule' },\n    { id: 'dispatch', label: 'Dispatch', icon: 'Truck', path: '/dispatch' },\n    { id: 'jobs', label: 'Jobs', icon: 'Briefcase', path: '/jobs' },\n    { id: 'customers', label: 'Customers', icon: 'Users', path: '/customers' },\n    { id: 'quotes', label: 'Quotes', icon: 'FileText', path: '/quotes' },\n    { id: 'invoices', label: 'Invoices', icon: 'Receipt', path: '/invoices' },\n    { id: 'reports', label: 'Reports', icon: 'BarChart3', path: '/reports' },\n    { id: 'team', label: 'Team', icon: 'UserCog', path: '/team' },\n    { id: 'settings', label: 'Settings', icon: 'Settings', path: '/settings' }\n  ],\n  office: [\n    { id: 'dashboard', label: 'Dashboard', icon: 'LayoutDashboard', path: '/' },\n    { id: 'schedule', label: 'Schedule', icon: 'Calendar', path: '/schedule' },\n    { id: 'dispatch', label: 'Dispatch', icon: 'Truck', path: '/dispatch' },\n    { id: 'jobs', label: 'Jobs', icon: 'Briefcase', path: '/jobs' },\n    { id: 'customers', label: 'Customers', icon: 'Users', path: '/customers' },\n    { id: 'quotes', label: 'Quotes', icon: 'FileText', path: '/quotes' },\n    { id: 'invoices', label: 'Invoices', icon: 'Receipt', path: '/invoices' },\n    { id: 'reports', label: 'Reports', icon: 'BarChart3', path: '/reports' }\n  ],\n  field_tech: [\n    { id: 'my_day', label: 'My Day', icon: 'Calendar', path: '/' },\n    { id: 'current_job', label: 'Current Job', icon: 'Briefcase', path: '/job' },\n    { id: 'time', label: 'Time', icon: 'Clock', path: '/time' }\n  ],\n  customer: [\n    { id: 'home', label: 'Home', icon: 'Home', path: '/' },\n    { id: 'appointments', label: 'Appointments', icon: 'Calendar', path: '/appointments' },\n    { id: 'quotes', label: 'Quotes', icon: 'FileText', path: '/quotes' },\n    { id: 'invoices', label: 'Invoices', icon: 'Receipt', path: '/invoices' },\n    { id: 'messages', label: 'Messages', icon: 'MessageSquare', path: '/messages' }\n  ]\n};\n\ninterface AppShellProps {\n  children: React.ReactNode;\n  currentPath: string;\n  onNavigate: (path: string) => void;\n}\n\nexport const AppShell: React.FC<AppShellProps> = ({ children, currentPath, onNavigate }) => {\n  const { role, setRole, validate } = useKernel();\n  const [sidebarOpen, setSidebarOpen] = useState(true);\n  const [mobileMenuOpen, setMobileMenuOpen] = useState(false);\n  const [userMenuOpen, setUserMenuOpen] = useState(false);\n  const [lastValidation, setLastValidation] = useState<ValidationResponse | null>(null);\n  \n  const navItems = navigation[role];\n  \n  const handleNavigation = useCallback((path: string, navId: string) => {\n    const action = `view:${navId}`;\n    const result = validate(action, { authenticated: true, mfa_verified: true, gps_enabled: true });\n    setLastValidation(result);\n    \n    if (result.result === 'ALLOWED') {\n      onNavigate(path);\n      setMobileMenuOpen(false);\n    }\n  }, [validate, onNavigate]);\n  \n  const roleLabels: Record<Role, string> = {\n    admin: 'Administrator',\n    office: 'Office Staff',\n    field_tech: 'Field Technician',\n    customer: 'Customer'\n  };\n  \n  const roleColors: Record<Role, string> = {\n    admin: 'bg-red-600',\n    office: 'bg-blue-600',\n    field_tech: 'bg-green-600',\n    customer: 'bg-purple-600'\n  };\n  \n  return (\n    <div className=\"min-h-screen bg-slate-50\">\n      {/* Top Bar */}\n      <header className=\"fixed top-0 left-0 right-0 h-16 bg-white border-b border-slate-200 z-50 flex items-center justify-between px-4\">\n        <div className=\"flex items-center gap-4\">\n          <button\n            onClick={() => setSidebarOpen(!sidebarOpen)}\n            className=\"hidden lg:flex p-2 hover:bg-slate-100 rounded-lg\"\n          >\n            <Menu className=\"w-5 h-5 text-slate-600\" />\n          </button>\n          <button\n            onClick={() => setMobileMenuOpen(!mobileMenuOpen)}\n            className=\"lg:hidden p-2 hover:bg-slate-100 rounded-lg\"\n          >\n            {mobileMenuOpen ? <X className=\"w-5 h-5\" /> : <Menu className=\"w-5 h-5\" />}\n          </button>\n          <div className=\"flex items-center gap-2\">\n            <div className=\"w-8 h-8 bg-gradient-to-br from-orange-500 to-red-600 rounded-lg flex items-center justify-center\">\n              <span className=\"text-white font-bold text-sm\">T</span>\n            </div>\n            <span className=\"font-semibold text-slate-800 text-lg\">TradeOS</span>\n          </div>\n        </div>\n        \n        <div className=\"flex items-center gap-3\">\n          {/* Kernel Status */}\n          <div className=\"hidden md:flex items-center gap-2 px-3 py-1.5 bg-green-50 border border-green-200 rounded-full\">\n            <Shield className=\"w-4 h-4 text-green-600\" />\n            <span className=\"text-xs text-green-700 font-medium\">L1 Kernel Active</span>\n            {lastValidation && (\n              <span className=\"text-xs text-green-600\">{lastValidation.latencyMs.toFixed(3)}ms</span>\n            )}\n          </div>\n          \n          {/* Notifications */}\n          <button className=\"p-2 hover:bg-slate-100 rounded-lg relative\">\n            <Bell className=\"w-5 h-5 text-slate-600\" />\n            <span className=\"absolute top-1 right-1 w-2 h-2 bg-red-500 rounded-full\"></span>\n          </button>\n          \n          {/* User Menu */}\n          <div className=\"relative\">\n            <button\n              onClick={() => setUserMenuOpen(!userMenuOpen)}\n              className=\"flex items-center gap-2 p-2 hover:bg-slate-100 rounded-lg\"\n            >\n              <div className={`w-8 h-8 ${roleColors[role]} rounded-full flex items-center justify-center`}>\n                <User className=\"w-4 h-4 text-white\" />\n              </div>\n              <div className=\"hidden md:block text-left\">\n                <div className=\"text-sm font-medium text-slate-800\">Demo User</div>\n                <div className=\"text-xs text-slate-500\">{roleLabels[role]}</div>\n              </div>\n              <ChevronDown className=\"w-4 h-4 text-slate-400\" />\n            </button>\n            \n            {userMenuOpen && (\n              <div className=\"absolute right-0 top-full mt-2 w-64 bg-white border border-slate-200 rounded-lg shadow-lg py-2 z-50\">\n                <div className=\"px-4 py-2 border-b border-slate-100\">\n                  <div className=\"text-xs text-slate-500 mb-2\">Switch Role (Demo)</div>\n                  {(Object.keys(roleLabels) as Role[]).map((r) => (\n                    <button\n                      key={r}\n                      onClick={() => { setRole(r); setUserMenuOpen(false); }}\n                      className={`w-full text-left px-3 py-2 rounded-lg text-sm flex items-center gap-2 ${\n                        role === r ? 'bg-slate-100 font-medium' : 'hover:bg-slate-50'\n                      }`}\n                    >\n                      <div className={`w-3 h-3 ${roleColors[r]} rounded-full`}></div>\n                      {roleLabels[r]}\n                    </button>\n                  ))}\n                </div>\n                <button className=\"w-full text-left px-4 py-2 text-sm text-slate-600 hover:bg-slate-50 flex items-center gap-2\">\n                  <LogOut className=\"w-4 h-4\" />\n                  Sign Out\n                </button>\n              </div>\n            )}\n          </div>\n        </div>\n      </header>\n      \n      {/* Mobile Menu */}\n      {mobileMenuOpen && (\n        <div className=\"fixed inset-0 top-16 bg-white z-40 lg:hidden overflow-y-auto\">\n          <nav className=\"p-4 space-y-1\">\n            {navItems.map((item) => {\n              const Icon = iconMap[item.icon];\n              const isActive = currentPath === item.path;\n              return (\n                <button\n                  key={item.id}\n                  onClick={() => handleNavigation(item.path, item.id)}\n                  className={`w-full flex items-center gap-3 px-4 py-3 rounded-lg text-left ${\n                    isActive\n                      ? 'bg-orange-50 text-orange-700 font-medium'\n                      : 'text-slate-600 hover:bg-slate-50'\n                  }`}\n                >\n                  {Icon && <Icon className=\"w-5 h-5\" />}\n                  {item.label}\n                </button>\n              );\n            })}\n          </nav>\n        </div>\n      )}\n      \n      {/* Sidebar (Desktop) */}\n      <aside className={`fixed top-16 left-0 bottom-0 bg-white border-r border-slate-200 transition-all duration-200 z-30 hidden lg:block ${\n        sidebarOpen ? 'w-64' : 'w-20'\n      }`}>\n        <nav className=\"p-4 space-y-1\">\n          {navItems.map((item) => {\n            const Icon = iconMap[item.icon];\n            const isActive = currentPath === item.path;\n            return (\n              <button\n                key={item.id}\n                onClick={() => handleNavigation(item.path, item.id)}\n                className={`w-full flex items-center gap-3 px-4 py-3 rounded-lg text-left ${\n                  isActive\n                    ? 'bg-orange-50 text-orange-700 font-medium'\n                    : 'text-slate-600 hover:bg-slate-50'\n                }`}\n                title={!sidebarOpen ? item.label : undefined}\n              >\n                {Icon && <Icon className=\"w-5 h-5 flex-shrink-0\" />}\n                {sidebarOpen && <span>{item.label}</span>}\n              </button>\n            );\n          })}\n        </nav>\n      </aside>\n      \n      {/* Main Content */}\n      <main className={`pt-16 transition-all duration-200 ${\n        sidebarOpen ? 'lg:pl-64' : 'lg:pl-20'\n      }`}>\n        <div className=\"p-6\">\n          {/* Validation Toast */}\n          {lastValidation && lastValidation.result !== 'ALLOWED' && (\n            <div className={`mb-4 p-4 rounded-lg border ${\n              lastValidation.result === 'DENIED'\n                ? 'bg-red-50 border-red-200 text-red-700'\n                : lastValidation.result === 'ESCALATE'\n                ? 'bg-amber-50 border-amber-200 text-amber-700'\n                : 'bg-slate-50 border-slate-200 text-slate-700'\n            }`}>\n              <div className=\"font-medium\">{lastValidation.result}</div>\n              <div className=\"text-sm\">{lastValidation.reason}</div>\n              <div className=\"text-xs mt-1 opacity-70\">Audit: {lastValidation.auditId}</div>\n            </div>\n          )}\n          {children}\n        </div>\n      </main>\n    </div>\n  );\n};\n\nexport default AppShell;"
  }
}
