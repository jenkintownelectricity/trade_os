<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>TradeOS - Unified Contractor Operations Platform</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://unpkg.com/react@18.2.0/umd/react.production.min.js"></script>
  <script src="https://unpkg.com/react-dom@18.2.0/umd/react-dom.production.min.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <script src="https://unpkg.com/lucide@latest"></script>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body { font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif; }
    @keyframes pulse { 0%, 100% { opacity: 1; } 50% { opacity: 0.5; } }
    .animate-pulse { animation: pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite; }
  </style>
  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            tradeos: {
              primary: '#f97316',
              secondary: '#ea580c',
            }
          }
        }
      }
    }
  </script>
</head>
<body>
  <div id="root"></div>

  <script type="text/babel" data-type="module">
    const { useState, useCallback, createContext, useContext, useEffect } = React;

    // ============================================================
    // TRADEOS BOUNDARIES - Role-based permissions
    // ============================================================
    const TRADEOS_BOUNDARIES = {
      admin: {
        allowed: [
          'view:*', 'create:*', 'update:*', 'delete:*',
          'dispatch:*', 'schedule:*', 'invoice:*', 'payment:*',
          'report:*', 'settings:*', 'user:*', 'export:*',
          'lead:create', 'lead:update', 'campaign:create', 'campaign:send',
          'enrollment:create', 'plan:create', 'agreement:cancel', 'agreement:renew',
          'timeoff:approve', 'po:create', 'po:approve', 'po:receive',
          'change_order:approve'
        ],
        denied: [
          { action: 'boundary:modify', reason: 'Requires L0 approval outside system' },
          { action: 'audit:delete', reason: 'Audit logs are immutable' },
          { action: 'kernel:modify', reason: 'Kernel is immutable at runtime' }
        ],
        escalation: [
          { condition: 'payment:refund', threshold: 10000, escalateTo: 'L0_HUMAN' },
          { condition: 'delete:customer', escalateTo: 'L0_HUMAN' },
          { condition: 'export:all_data', escalateTo: 'L0_HUMAN' }
        ],
        requires: ['authenticated', 'mfa_verified']
      },
      office: {
        allowed: [
          'view:dashboard', 'view:schedule', 'view:jobs', 'view:customers',
          'view:invoices', 'view:reports', 'create:job', 'create:customer',
          'create:quote', 'create:invoice', 'update:job', 'update:customer',
          'update:schedule', 'dispatch:assign', 'dispatch:reassign',
          'schedule:create', 'schedule:update', 'invoice:create', 'invoice:send',
          'payment:record', 'communication:send', 'report:view',
          'lead:create', 'lead:update', 'campaign:send',
          'enrollment:create', 'agreement:cancel', 'agreement:renew',
          'timeoff:approve', 'po:create', 'po:receive'
        ],
        denied: [
          { action: 'delete:customer', reason: 'Requires admin approval' },
          { action: 'delete:invoice', reason: 'Invoices are immutable records' },
          { action: 'payment:refund', reason: 'Requires admin approval' },
          { action: 'settings:modify', reason: 'Admin only' },
          { action: 'user:create', reason: 'Admin only' },
          { action: 'export:all_data', reason: 'Admin only' }
        ],
        escalation: [
          { condition: 'invoice:create', threshold: 50000, escalateTo: 'admin' },
          { condition: 'discount:apply', threshold: 20, escalateTo: 'admin' }
        ],
        requires: ['authenticated']
      },
      field_tech: {
        allowed: [
          'view:my_schedule', 'view:job_details', 'view:customer_contact',
          'view:job_history', 'update:job_status', 'update:job_notes',
          'update:job_photos', 'update:checklist', 'create:job_note',
          'create:photo', 'create:signature', 'time:clock_in', 'time:clock_out',
          'time:break', 'dispatch:accept', 'dispatch:en_route', 'dispatch:arrive',
          'dispatch:complete', 'communication:customer_notify'
        ],
        denied: [
          { action: 'view:all_schedule', reason: 'Can only view own schedule' },
          { action: 'view:financials', reason: 'Financial data restricted' },
          { action: 'create:invoice', reason: 'Office creates invoices' },
          { action: 'create:quote', reason: 'Office creates quotes' },
          { action: 'update:pricing', reason: 'Price book is office managed' },
          { action: 'delete:*', reason: 'Field techs cannot delete records' },
          { action: 'dispatch:reassign', reason: 'Cannot reassign own jobs' }
        ],
        escalation: [
          { condition: 'job:additional_work', threshold: 500, escalateTo: 'office' },
          { condition: 'customer:complaint', escalateTo: 'office' }
        ],
        requires: ['authenticated', 'gps_enabled']
      },
      customer: {
        allowed: [
          'view:my_appointments', 'view:my_quotes', 'view:my_invoices',
          'view:my_history', 'view:tech_location', 'view:project_progress',
          'create:service_request', 'create:message', 'update:my_profile',
          'payment:make', 'quote:approve', 'quote:decline', 'appointment:request_change'
        ],
        denied: [
          { action: 'view:other_customers', reason: 'Privacy - own data only' },
          { action: 'view:internal_notes', reason: 'Internal use only' },
          { action: 'view:pricing_markup', reason: 'Business confidential' },
          { action: 'create:job', reason: 'Jobs created by office' },
          { action: 'update:job', reason: 'Jobs managed by staff' },
          { action: 'delete:*', reason: 'Customers cannot delete records' }
        ],
        escalation: [
          { condition: 'complaint:file', escalateTo: 'office' },
          { condition: 'payment:dispute', escalateTo: 'admin' }
        ],
        requires: ['authenticated']
      }
    };

    // ============================================================
    // KERNEL - Validation Engine
    // ============================================================
    const auditLog = [];

    const generateAuditId = (action, role, timestamp) => {
      const data = `${action}:${role}:${timestamp}`;
      let hash = 0;
      for (let i = 0; i < data.length; i++) {
        const char = data.charCodeAt(i);
        hash = ((hash << 5) - hash) + char;
        hash = hash & hash;
      }
      return `AUDIT-${Math.abs(hash).toString(16).toUpperCase().padStart(8, '0')}`;
    };

    const validateAction = (request, boundaries) => {
      const startTime = performance.now();
      const timestamp = request.timestamp || Date.now();
      const auditId = generateAuditId(request.action, request.role, timestamp);

      const boundary = boundaries[request.role];

      if (!boundary) {
        const response = {
          result: 'DENIED',
          action: request.action,
          role: request.role,
          reason: 'No boundary defined for role',
          auditId,
          latencyMs: performance.now() - startTime
        };
        auditLog.push(response);
        return response;
      }

      if (boundary.requires.length > 0 && request.context) {
        for (const req of boundary.requires) {
          if (!request.context[req]) {
            const response = {
              result: 'MISSING_REQUIREMENT',
              action: request.action,
              role: request.role,
              reason: `Missing requirement: ${req}`,
              auditId,
              latencyMs: performance.now() - startTime
            };
            auditLog.push(response);
            return response;
          }
        }
      }

      const deniedRule = boundary.denied.find(d => {
        if (d.action.endsWith('*')) {
          return request.action.startsWith(d.action.slice(0, -1));
        }
        return d.action === request.action;
      });
      if (deniedRule) {
        const response = {
          result: 'DENIED',
          action: request.action,
          role: request.role,
          reason: deniedRule.reason,
          auditId,
          latencyMs: performance.now() - startTime
        };
        auditLog.push(response);
        return response;
      }

      for (const rule of boundary.escalation) {
        if (request.action.includes(rule.condition)) {
          if (rule.threshold && request.context?.amount) {
            if (request.context.amount >= rule.threshold) {
              const response = {
                result: 'ESCALATE',
                action: request.action,
                role: request.role,
                reason: `Amount ${request.context.amount} exceeds threshold ${rule.threshold}`,
                escalateTo: rule.escalateTo,
                auditId,
                latencyMs: performance.now() - startTime
              };
              auditLog.push(response);
              return response;
            }
          }
        }
      }

      const isAllowed = boundary.allowed.some(allowed => {
        if (allowed.endsWith('*')) {
          return request.action.startsWith(allowed.slice(0, -1));
        }
        return allowed === request.action;
      });

      if (isAllowed) {
        const response = {
          result: 'ALLOWED',
          action: request.action,
          role: request.role,
          auditId,
          latencyMs: performance.now() - startTime
        };
        auditLog.push(response);
        return response;
      }

      const response = {
        result: 'DENIED',
        action: request.action,
        role: request.role,
        reason: 'Action not in allowed list',
        auditId,
        latencyMs: performance.now() - startTime
      };
      auditLog.push(response);
      return response;
    };

    const getAuditLog = () => [...auditLog];

    // Kernel Context
    const KernelContext = createContext(null);

    const useKernel = () => {
      const context = useContext(KernelContext);
      if (!context) throw new Error('useKernel must be used within KernelProvider');
      return context;
    };

    const KernelProvider = ({ children, boundaries, initialRole = 'customer' }) => {
      const [role, setRole] = useState(initialRole);

      const validate = useCallback((action, context) => {
        return validateAction({ action, role, context }, boundaries);
      }, [role, boundaries]);

      return React.createElement(KernelContext.Provider, {
        value: { validate, role, setRole, boundaries, auditLog: getAuditLog() }
      }, children);
    };

    // ============================================================
    // AUTH CONTEXT
    // ============================================================
    const DEMO_USERS = {
      'admin@tradeos.demo': { id: 'user-001', email: 'admin@tradeos.demo', name: 'Alex Admin', role: 'admin', authenticated: true, mfa_verified: true, gps_enabled: true },
      'office@tradeos.demo': { id: 'user-002', email: 'office@tradeos.demo', name: 'Olivia Office', role: 'office', authenticated: true, mfa_verified: false, gps_enabled: true },
      'tech@tradeos.demo': { id: 'user-003', email: 'tech@tradeos.demo', name: 'Tyler Tech', role: 'field_tech', authenticated: true, mfa_verified: false, gps_enabled: true },
      'customer@tradeos.demo': { id: 'user-004', email: 'customer@tradeos.demo', name: 'Chris Customer', role: 'customer', authenticated: true, mfa_verified: false, gps_enabled: false }
    };

    const AuthContext = createContext(null);

    const useAuth = () => {
      const context = useContext(AuthContext);
      if (!context) throw new Error('useAuth must be used within AuthProvider');
      return context;
    };

    const AuthProvider = ({ children }) => {
      const [user, setUser] = useState(null);
      const [isLoading, setIsLoading] = useState(false);

      const login = useCallback(async (email, password) => {
        setIsLoading(true);
        await new Promise(resolve => setTimeout(resolve, 300));
        const demoUser = DEMO_USERS[email.toLowerCase()];
        if (demoUser) {
          setUser(demoUser);
          setIsLoading(false);
          return true;
        }
        setIsLoading(false);
        return false;
      }, []);

      const logout = useCallback(() => setUser(null), []);

      return React.createElement(AuthContext.Provider, {
        value: { user, isLoading, login, logout, isAuthenticated: !!user }
      }, children);
    };

    // ============================================================
    // ICON COMPONENTS (Using Lucide via CDN)
    // ============================================================
    const Icon = ({ name, className = "w-5 h-5" }) => {
      useEffect(() => {
        if (window.lucide) {
          window.lucide.createIcons();
        }
      }, []);
      return React.createElement('i', { 'data-lucide': name, className });
    };

    // Simple SVG Icons as React components
    const Icons = {
      LayoutDashboard: (props) => React.createElement('svg', { xmlns: "http://www.w3.org/2000/svg", viewBox: "0 0 24 24", fill: "none", stroke: "currentColor", strokeWidth: "2", strokeLinecap: "round", strokeLinejoin: "round", ...props }, React.createElement('rect', { width: "7", height: "9", x: "3", y: "3", rx: "1" }), React.createElement('rect', { width: "7", height: "5", x: "14", y: "3", rx: "1" }), React.createElement('rect', { width: "7", height: "9", x: "14", y: "12", rx: "1" }), React.createElement('rect', { width: "7", height: "5", x: "3", y: "16", rx: "1" })),
      Users: (props) => React.createElement('svg', { xmlns: "http://www.w3.org/2000/svg", viewBox: "0 0 24 24", fill: "none", stroke: "currentColor", strokeWidth: "2", strokeLinecap: "round", strokeLinejoin: "round", ...props }, React.createElement('path', { d: "M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2" }), React.createElement('circle', { cx: "9", cy: "7", r: "4" }), React.createElement('path', { d: "M22 21v-2a4 4 0 0 0-3-3.87" }), React.createElement('path', { d: "M16 3.13a4 4 0 0 1 0 7.75" })),
      Target: (props) => React.createElement('svg', { xmlns: "http://www.w3.org/2000/svg", viewBox: "0 0 24 24", fill: "none", stroke: "currentColor", strokeWidth: "2", strokeLinecap: "round", strokeLinejoin: "round", ...props }, React.createElement('circle', { cx: "12", cy: "12", r: "10" }), React.createElement('circle', { cx: "12", cy: "12", r: "6" }), React.createElement('circle', { cx: "12", cy: "12", r: "2" })),
      Megaphone: (props) => React.createElement('svg', { xmlns: "http://www.w3.org/2000/svg", viewBox: "0 0 24 24", fill: "none", stroke: "currentColor", strokeWidth: "2", strokeLinecap: "round", strokeLinejoin: "round", ...props }, React.createElement('path', { d: "m3 11 18-5v12L3 14v-3z" }), React.createElement('path', { d: "M11.6 16.8a3 3 0 1 1-5.8-1.6" })),
      FileText: (props) => React.createElement('svg', { xmlns: "http://www.w3.org/2000/svg", viewBox: "0 0 24 24", fill: "none", stroke: "currentColor", strokeWidth: "2", strokeLinecap: "round", strokeLinejoin: "round", ...props }, React.createElement('path', { d: "M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z" }), React.createElement('polyline', { points: "14 2 14 8 20 8" }), React.createElement('line', { x1: "16", x2: "8", y1: "13", y2: "13" }), React.createElement('line', { x1: "16", x2: "8", y1: "17", y2: "17" }), React.createElement('line', { x1: "10", x2: "8", y1: "9", y2: "9" })),
      UserCog: (props) => React.createElement('svg', { xmlns: "http://www.w3.org/2000/svg", viewBox: "0 0 24 24", fill: "none", stroke: "currentColor", strokeWidth: "2", strokeLinecap: "round", strokeLinejoin: "round", ...props }, React.createElement('circle', { cx: "18", cy: "15", r: "3" }), React.createElement('circle', { cx: "9", cy: "7", r: "4" }), React.createElement('path', { d: "M10 15H6a4 4 0 0 0-4 4v2" }), React.createElement('path', { d: "m21.7 16.4-.9-.3" }), React.createElement('path', { d: "m15.2 13.9-.9-.3" }), React.createElement('path', { d: "m16.6 18.7.3-.9" }), React.createElement('path', { d: "m19.1 12.2.3-.9" }), React.createElement('path', { d: "m19.6 18.7-.4-1" }), React.createElement('path', { d: "m16.8 12.3-.4-1" }), React.createElement('path', { d: "m14.3 16.6 1-.4" }), React.createElement('path', { d: "m20.7 13.8 1-.4" })),
      Package: (props) => React.createElement('svg', { xmlns: "http://www.w3.org/2000/svg", viewBox: "0 0 24 24", fill: "none", stroke: "currentColor", strokeWidth: "2", strokeLinecap: "round", strokeLinejoin: "round", ...props }, React.createElement('path', { d: "m7.5 4.27 9 5.15" }), React.createElement('path', { d: "M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z" }), React.createElement('path', { d: "m3.3 7 8.7 5 8.7-5" }), React.createElement('path', { d: "M12 22V12" })),
      Building: (props) => React.createElement('svg', { xmlns: "http://www.w3.org/2000/svg", viewBox: "0 0 24 24", fill: "none", stroke: "currentColor", strokeWidth: "2", strokeLinecap: "round", strokeLinejoin: "round", ...props }, React.createElement('rect', { width: "16", height: "20", x: "4", y: "2", rx: "2", ry: "2" }), React.createElement('path', { d: "M9 22v-4h6v4" }), React.createElement('path', { d: "M8 6h.01" }), React.createElement('path', { d: "M16 6h.01" }), React.createElement('path', { d: "M12 6h.01" }), React.createElement('path', { d: "M12 10h.01" }), React.createElement('path', { d: "M12 14h.01" }), React.createElement('path', { d: "M16 10h.01" }), React.createElement('path', { d: "M16 14h.01" }), React.createElement('path', { d: "M8 10h.01" }), React.createElement('path', { d: "M8 14h.01" })),
      Settings: (props) => React.createElement('svg', { xmlns: "http://www.w3.org/2000/svg", viewBox: "0 0 24 24", fill: "none", stroke: "currentColor", strokeWidth: "2", strokeLinecap: "round", strokeLinejoin: "round", ...props }, React.createElement('path', { d: "M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z" }), React.createElement('circle', { cx: "12", cy: "12", r: "3" })),
      Shield: (props) => React.createElement('svg', { xmlns: "http://www.w3.org/2000/svg", viewBox: "0 0 24 24", fill: "none", stroke: "currentColor", strokeWidth: "2", strokeLinecap: "round", strokeLinejoin: "round", ...props }, React.createElement('path', { d: "M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10" })),
      Menu: (props) => React.createElement('svg', { xmlns: "http://www.w3.org/2000/svg", viewBox: "0 0 24 24", fill: "none", stroke: "currentColor", strokeWidth: "2", strokeLinecap: "round", strokeLinejoin: "round", ...props }, React.createElement('line', { x1: "4", x2: "20", y1: "12", y2: "12" }), React.createElement('line', { x1: "4", x2: "20", y1: "6", y2: "6" }), React.createElement('line', { x1: "4", x2: "20", y1: "18", y2: "18" })),
      X: (props) => React.createElement('svg', { xmlns: "http://www.w3.org/2000/svg", viewBox: "0 0 24 24", fill: "none", stroke: "currentColor", strokeWidth: "2", strokeLinecap: "round", strokeLinejoin: "round", ...props }, React.createElement('path', { d: "M18 6 6 18" }), React.createElement('path', { d: "m6 6 12 12" })),
      Bell: (props) => React.createElement('svg', { xmlns: "http://www.w3.org/2000/svg", viewBox: "0 0 24 24", fill: "none", stroke: "currentColor", strokeWidth: "2", strokeLinecap: "round", strokeLinejoin: "round", ...props }, React.createElement('path', { d: "M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9" }), React.createElement('path', { d: "M10.3 21a1.94 1.94 0 0 0 3.4 0" })),
      User: (props) => React.createElement('svg', { xmlns: "http://www.w3.org/2000/svg", viewBox: "0 0 24 24", fill: "none", stroke: "currentColor", strokeWidth: "2", strokeLinecap: "round", strokeLinejoin: "round", ...props }, React.createElement('path', { d: "M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2" }), React.createElement('circle', { cx: "12", cy: "7", r: "4" })),
      ChevronDown: (props) => React.createElement('svg', { xmlns: "http://www.w3.org/2000/svg", viewBox: "0 0 24 24", fill: "none", stroke: "currentColor", strokeWidth: "2", strokeLinecap: "round", strokeLinejoin: "round", ...props }, React.createElement('path', { d: "m6 9 6 6 6-6" })),
      LogOut: (props) => React.createElement('svg', { xmlns: "http://www.w3.org/2000/svg", viewBox: "0 0 24 24", fill: "none", stroke: "currentColor", strokeWidth: "2", strokeLinecap: "round", strokeLinejoin: "round", ...props }, React.createElement('path', { d: "M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4" }), React.createElement('polyline', { points: "16 17 21 12 16 7" }), React.createElement('line', { x1: "21", x2: "9", y1: "12", y2: "12" })),
      Lock: (props) => React.createElement('svg', { xmlns: "http://www.w3.org/2000/svg", viewBox: "0 0 24 24", fill: "none", stroke: "currentColor", strokeWidth: "2", strokeLinecap: "round", strokeLinejoin: "round", ...props }, React.createElement('rect', { width: "18", height: "11", x: "3", y: "11", rx: "2", ry: "2" }), React.createElement('path', { d: "M7 11V7a5 5 0 0 1 10 0v4" })),
      Mail: (props) => React.createElement('svg', { xmlns: "http://www.w3.org/2000/svg", viewBox: "0 0 24 24", fill: "none", stroke: "currentColor", strokeWidth: "2", strokeLinecap: "round", strokeLinejoin: "round", ...props }, React.createElement('rect', { width: "20", height: "16", x: "2", y: "4", rx: "2" }), React.createElement('path', { d: "m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7" })),
      Eye: (props) => React.createElement('svg', { xmlns: "http://www.w3.org/2000/svg", viewBox: "0 0 24 24", fill: "none", stroke: "currentColor", strokeWidth: "2", strokeLinecap: "round", strokeLinejoin: "round", ...props }, React.createElement('path', { d: "M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z" }), React.createElement('circle', { cx: "12", cy: "12", r: "3" })),
      EyeOff: (props) => React.createElement('svg', { xmlns: "http://www.w3.org/2000/svg", viewBox: "0 0 24 24", fill: "none", stroke: "currentColor", strokeWidth: "2", strokeLinecap: "round", strokeLinejoin: "round", ...props }, React.createElement('path', { d: "M9.88 9.88a3 3 0 1 0 4.24 4.24" }), React.createElement('path', { d: "M10.73 5.08A10.43 10.43 0 0 1 12 5c7 0 10 7 10 7a13.16 13.16 0 0 1-1.67 2.68" }), React.createElement('path', { d: "M6.61 6.61A13.526 13.526 0 0 0 2 12s3 7 10 7a9.74 9.74 0 0 0 5.39-1.61" }), React.createElement('line', { x1: "2", x2: "22", y1: "2", y2: "22" })),
      Loader: (props) => React.createElement('svg', { xmlns: "http://www.w3.org/2000/svg", viewBox: "0 0 24 24", fill: "none", stroke: "currentColor", strokeWidth: "2", strokeLinecap: "round", strokeLinejoin: "round", className: `${props.className || ''} animate-spin`, ...props }, React.createElement('path', { d: "M21 12a9 9 0 1 1-6.219-8.56" })),
      TrendingUp: (props) => React.createElement('svg', { xmlns: "http://www.w3.org/2000/svg", viewBox: "0 0 24 24", fill: "none", stroke: "currentColor", strokeWidth: "2", strokeLinecap: "round", strokeLinejoin: "round", ...props }, React.createElement('polyline', { points: "22 7 13.5 15.5 8.5 10.5 2 17" }), React.createElement('polyline', { points: "16 7 22 7 22 13" })),
      DollarSign: (props) => React.createElement('svg', { xmlns: "http://www.w3.org/2000/svg", viewBox: "0 0 24 24", fill: "none", stroke: "currentColor", strokeWidth: "2", strokeLinecap: "round", strokeLinejoin: "round", ...props }, React.createElement('line', { x1: "12", x2: "12", y1: "2", y2: "22" }), React.createElement('path', { d: "M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6" })),
      CheckCircle: (props) => React.createElement('svg', { xmlns: "http://www.w3.org/2000/svg", viewBox: "0 0 24 24", fill: "none", stroke: "currentColor", strokeWidth: "2", strokeLinecap: "round", strokeLinejoin: "round", ...props }, React.createElement('path', { d: "M22 11.08V12a10 10 0 1 1-5.93-9.14" }), React.createElement('path', { d: "m9 11 3 3L22 4" })),
      AlertTriangle: (props) => React.createElement('svg', { xmlns: "http://www.w3.org/2000/svg", viewBox: "0 0 24 24", fill: "none", stroke: "currentColor", strokeWidth: "2", strokeLinecap: "round", strokeLinejoin: "round", ...props }, React.createElement('path', { d: "m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z" }), React.createElement('path', { d: "M12 9v4" }), React.createElement('path', { d: "M12 17h.01" })),
      Plus: (props) => React.createElement('svg', { xmlns: "http://www.w3.org/2000/svg", viewBox: "0 0 24 24", fill: "none", stroke: "currentColor", strokeWidth: "2", strokeLinecap: "round", strokeLinejoin: "round", ...props }, React.createElement('path', { d: "M5 12h14" }), React.createElement('path', { d: "M12 5v14" })),
      Star: (props) => React.createElement('svg', { xmlns: "http://www.w3.org/2000/svg", viewBox: "0 0 24 24", fill: "none", stroke: "currentColor", strokeWidth: "2", strokeLinecap: "round", strokeLinejoin: "round", ...props }, React.createElement('polygon', { points: "12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2" })),
      Clock: (props) => React.createElement('svg', { xmlns: "http://www.w3.org/2000/svg", viewBox: "0 0 24 24", fill: "none", stroke: "currentColor", strokeWidth: "2", strokeLinecap: "round", strokeLinejoin: "round", ...props }, React.createElement('circle', { cx: "12", cy: "12", r: "10" }), React.createElement('polyline', { points: "12 6 12 12 16 14" })),
    };

    // ============================================================
    // LOGIN PAGE COMPONENT
    // ============================================================
    const LoginPage = ({ onLogin }) => {
      const { login, isLoading } = useAuth();
      const [email, setEmail] = useState('');
      const [password, setPassword] = useState('');
      const [showPassword, setShowPassword] = useState(false);
      const [error, setError] = useState('');

      const handleSubmit = async (e) => {
        e.preventDefault();
        setError('');
        const success = await login(email, password);
        if (success) {
          const user = DEMO_USERS[email.toLowerCase()];
          if (user) onLogin(user.role);
        } else {
          setError('Invalid credentials. Use a demo email.');
        }
      };

      const handleQuickLogin = async (userEmail) => {
        setEmail(userEmail);
        const success = await login(userEmail, 'demo');
        if (success) {
          const user = DEMO_USERS[userEmail];
          if (user) onLogin(user.role);
        }
      };

      return React.createElement('div', { className: "min-h-screen bg-gradient-to-br from-slate-900 via-slate-800 to-slate-900 flex items-center justify-center p-4" },
        React.createElement('div', { className: "w-full max-w-md" },
          React.createElement('div', { className: "text-center mb-8" },
            React.createElement('div', { className: "inline-flex items-center gap-3 mb-4" },
              React.createElement('div', { className: "w-12 h-12 bg-gradient-to-br from-orange-500 to-red-600 rounded-xl flex items-center justify-center shadow-lg" },
                React.createElement('span', { className: "text-white font-bold text-2xl" }, "T")
              ),
              React.createElement('span', { className: "text-white font-bold text-3xl" }, "TradeOS")
            ),
            React.createElement('p', { className: "text-slate-400" }, "Unified Contractor Operations Platform")
          ),
          React.createElement('div', { className: "bg-white rounded-2xl shadow-xl p-8" },
            React.createElement('div', { className: "flex items-center gap-2 mb-6 px-3 py-2 bg-green-50 border border-green-200 rounded-lg" },
              React.createElement(Icons.Shield, { className: "w-4 h-4 text-green-600" }),
              React.createElement('span', { className: "text-sm text-green-700" }, "Protected by LDS Kernel V1")
            ),
            React.createElement('form', { onSubmit: handleSubmit, className: "space-y-4" },
              React.createElement('div', null,
                React.createElement('label', { className: "block text-sm font-medium text-slate-700 mb-1" }, "Email"),
                React.createElement('div', { className: "relative" },
                  React.createElement(Icons.Mail, { className: "absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-slate-400" }),
                  React.createElement('input', { type: "email", value: email, onChange: (e) => setEmail(e.target.value), className: "w-full pl-10 pr-4 py-3 border border-slate-200 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-orange-500 outline-none", placeholder: "Enter your email" })
                )
              ),
              React.createElement('div', null,
                React.createElement('label', { className: "block text-sm font-medium text-slate-700 mb-1" }, "Password"),
                React.createElement('div', { className: "relative" },
                  React.createElement(Icons.Lock, { className: "absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-slate-400" }),
                  React.createElement('input', { type: showPassword ? 'text' : 'password', value: password, onChange: (e) => setPassword(e.target.value), className: "w-full pl-10 pr-12 py-3 border border-slate-200 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-orange-500 outline-none", placeholder: "Enter your password" }),
                  React.createElement('button', { type: "button", onClick: () => setShowPassword(!showPassword), className: "absolute right-3 top-1/2 -translate-y-1/2 text-slate-400 hover:text-slate-600" },
                    showPassword ? React.createElement(Icons.EyeOff, { className: "w-5 h-5" }) : React.createElement(Icons.Eye, { className: "w-5 h-5" })
                  )
                )
              ),
              error && React.createElement('div', { className: "p-3 bg-red-50 border border-red-200 rounded-lg text-red-700 text-sm" }, error),
              React.createElement('button', { type: "submit", disabled: isLoading, className: "w-full py-3 bg-gradient-to-r from-orange-500 to-red-600 text-white font-medium rounded-lg hover:from-orange-600 hover:to-red-700 transition-all disabled:opacity-50 flex items-center justify-center gap-2" },
                isLoading ? React.createElement(React.Fragment, null, React.createElement(Icons.Loader, { className: "w-5 h-5" }), " Signing in...") : "Sign In"
              )
            ),
            React.createElement('div', { className: "mt-8 pt-6 border-t border-slate-100" },
              React.createElement('div', { className: "text-xs text-slate-500 uppercase tracking-wide mb-3" }, "Quick Demo Login"),
              React.createElement('div', { className: "grid grid-cols-2 gap-2" },
                Object.entries(DEMO_USERS).map(([userEmail, userData]) =>
                  React.createElement('button', { key: userEmail, onClick: () => handleQuickLogin(userEmail), className: "p-3 text-left border border-slate-200 rounded-lg hover:border-orange-300 hover:bg-orange-50 transition-all" },
                    React.createElement('div', { className: "text-sm font-medium text-slate-700" }, userData.name),
                    React.createElement('div', { className: "text-xs text-slate-500 capitalize" }, userData.role.replace('_', ' '))
                  )
                )
              )
            )
          ),
          React.createElement('div', { className: "mt-6 text-center text-slate-400 text-sm" },
            "Built with LDS Streaming Architecture",
            React.createElement('br'),
            React.createElement('span', { className: "text-slate-500" }, "2026 Lefebvre Design Solutions")
          )
        )
      );
    };

    // ============================================================
    // DASHBOARD COMPONENT
    // ============================================================
    const Dashboard = () => {
      const { role } = useKernel();

      const stats = [
        { label: "Today's Jobs", value: "12", change: "+3", color: "text-blue-600", bg: "bg-blue-50" },
        { label: "Open Invoices", value: "$24,580", change: "+$5,200", color: "text-green-600", bg: "bg-green-50" },
        { label: "Active Leads", value: "28", change: "+7", color: "text-purple-600", bg: "bg-purple-50" },
        { label: "Team Members", value: "8", change: "0", color: "text-slate-600", bg: "bg-slate-50" }
      ];

      const recentJobs = [
        { id: 1, customer: "Johnson Residence", type: "HVAC Repair", tech: "Mike Johnson", status: "In Progress", time: "9:00 AM" },
        { id: 2, customer: "Smith Commercial", type: "Plumbing Install", tech: "James Martinez", status: "Scheduled", time: "11:30 AM" },
        { id: 3, customer: "Garcia Home", type: "AC Maintenance", tech: "Mike Johnson", status: "Completed", time: "2:00 PM" },
        { id: 4, customer: "Chen Office", type: "Electrical", tech: "David Brown", status: "Scheduled", time: "3:30 PM" }
      ];

      return React.createElement('div', { className: "space-y-6" },
        React.createElement('div', null,
          React.createElement('h1', { className: "text-2xl font-bold text-slate-800" }, "Dashboard"),
          React.createElement('p', { className: "text-slate-500" }, `Welcome back! Here's your ${role === 'admin' ? 'company' : role === 'field_tech' ? 'daily' : 'account'} overview.`)
        ),
        React.createElement('div', { className: "grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4" },
          stats.map((stat, i) =>
            React.createElement('div', { key: i, className: `${stat.bg} rounded-xl p-6 border border-slate-200` },
              React.createElement('p', { className: "text-sm text-slate-500 mb-1" }, stat.label),
              React.createElement('p', { className: `text-3xl font-bold ${stat.color}` }, stat.value),
              React.createElement('p', { className: "text-sm text-green-600 mt-2" }, stat.change, " from yesterday")
            )
          )
        ),
        React.createElement('div', { className: "bg-white rounded-xl border border-slate-200 overflow-hidden" },
          React.createElement('div', { className: "p-4 border-b border-slate-100" },
            React.createElement('h2', { className: "font-semibold text-slate-800" }, "Today's Schedule")
          ),
          React.createElement('div', { className: "divide-y divide-slate-100" },
            recentJobs.map(job =>
              React.createElement('div', { key: job.id, className: "p-4 hover:bg-slate-50 flex items-center justify-between" },
                React.createElement('div', null,
                  React.createElement('p', { className: "font-medium text-slate-800" }, job.customer),
                  React.createElement('p', { className: "text-sm text-slate-500" }, job.type, " - ", job.tech)
                ),
                React.createElement('div', { className: "text-right" },
                  React.createElement('span', { className: `px-2 py-1 rounded-full text-xs font-medium ${job.status === 'Completed' ? 'bg-green-100 text-green-700' : job.status === 'In Progress' ? 'bg-blue-100 text-blue-700' : 'bg-slate-100 text-slate-600'}` }, job.status),
                  React.createElement('p', { className: "text-sm text-slate-400 mt-1" }, job.time)
                )
              )
            )
          )
        )
      );
    };

    // ============================================================
    // SIMPLIFIED MODULE PLACEHOLDERS
    // ============================================================
    const CRM = () => {
      const { validate, role } = useKernel();
      const [opportunities] = useState([
        { id: 1, name: 'Martinez Residence', stage: 'lead', value: 2500, source: 'Website' },
        { id: 2, name: 'Thompson Home', stage: 'qualified', value: 8500, source: 'Referral' },
        { id: 3, name: 'Chen Commercial', stage: 'quote_sent', value: 15000, source: 'Google' },
        { id: 4, name: 'Garcia Home', stage: 'won', value: 6800, source: 'Facebook' }
      ]);

      const stages = ['lead', 'qualified', 'quote_sent', 'won', 'lost'];
      const stageLabels = { lead: 'Lead', qualified: 'Qualified', quote_sent: 'Quote Sent', won: 'Won', lost: 'Lost' };
      const stageColors = { lead: 'bg-slate-100', qualified: 'bg-blue-100', quote_sent: 'bg-purple-100', won: 'bg-green-100', lost: 'bg-red-100' };

      return React.createElement('div', { className: "space-y-6" },
        React.createElement('div', { className: "flex justify-between items-center" },
          React.createElement('div', null,
            React.createElement('h1', { className: "text-2xl font-bold text-slate-800" }, "CRM"),
            React.createElement('p', { className: "text-slate-500" }, "Manage leads and opportunities")
          ),
          React.createElement('button', { className: "px-4 py-2 bg-orange-500 text-white rounded-lg hover:bg-orange-600 flex items-center gap-2" },
            React.createElement(Icons.Plus, { className: "w-4 h-4" }), "Add Lead"
          )
        ),
        React.createElement('div', { className: "grid grid-cols-1 md:grid-cols-4 gap-4" },
          React.createElement('div', { className: "bg-white rounded-xl border p-4" },
            React.createElement('p', { className: "text-sm text-slate-500" }, "Pipeline Value"),
            React.createElement('p', { className: "text-2xl font-bold text-slate-800" }, "$32,800")
          ),
          React.createElement('div', { className: "bg-white rounded-xl border border-green-200 p-4" },
            React.createElement('p', { className: "text-sm text-green-600" }, "Won (MTD)"),
            React.createElement('p', { className: "text-2xl font-bold text-green-600" }, "$6,800")
          ),
          React.createElement('div', { className: "bg-white rounded-xl border p-4" },
            React.createElement('p', { className: "text-sm text-slate-500" }, "Active Leads"),
            React.createElement('p', { className: "text-2xl font-bold text-slate-800" }, "8")
          ),
          React.createElement('div', { className: "bg-white rounded-xl border p-4" },
            React.createElement('p', { className: "text-sm text-slate-500" }, "Win Rate"),
            React.createElement('p', { className: "text-2xl font-bold text-slate-800" }, "68%")
          )
        ),
        React.createElement('div', { className: "grid grid-cols-1 md:grid-cols-5 gap-4" },
          stages.map(stage =>
            React.createElement('div', { key: stage, className: `${stageColors[stage]} rounded-xl p-3 min-h-[300px]` },
              React.createElement('div', { className: "flex justify-between items-center mb-3" },
                React.createElement('span', { className: "font-medium text-slate-700" }, stageLabels[stage]),
                React.createElement('span', { className: "text-xs text-slate-500" }, opportunities.filter(o => o.stage === stage).length)
              ),
              React.createElement('div', { className: "space-y-2" },
                opportunities.filter(o => o.stage === stage).map(opp =>
                  React.createElement('div', { key: opp.id, className: "bg-white rounded-lg p-3 border shadow-sm" },
                    React.createElement('p', { className: "font-medium text-slate-800 text-sm" }, opp.name),
                    React.createElement('p', { className: "text-xs text-slate-500" }, opp.source),
                    React.createElement('p', { className: "font-bold text-slate-800 mt-2" }, "$", opp.value.toLocaleString())
                  )
                )
              )
            )
          )
        )
      );
    };

    const Marketing = () => {
      return React.createElement('div', { className: "space-y-6" },
        React.createElement('h1', { className: "text-2xl font-bold text-slate-800" }, "Marketing"),
        React.createElement('p', { className: "text-slate-500" }, "Campaigns, reviews, and referrals"),
        React.createElement('div', { className: "grid grid-cols-1 md:grid-cols-4 gap-4" },
          React.createElement('div', { className: "bg-white rounded-xl border p-4" },
            React.createElement('p', { className: "text-sm text-slate-500" }, "Emails Sent"),
            React.createElement('p', { className: "text-2xl font-bold text-slate-800" }, "4,567")
          ),
          React.createElement('div', { className: "bg-white rounded-xl border border-green-200 p-4" },
            React.createElement('p', { className: "text-sm text-green-600" }, "Revenue"),
            React.createElement('p', { className: "text-2xl font-bold text-green-600" }, "$26,700")
          ),
          React.createElement('div', { className: "bg-white rounded-xl border p-4" },
            React.createElement('p', { className: "text-sm text-slate-500" }, "Avg Rating"),
            React.createElement('div', { className: "flex items-center gap-2" },
              React.createElement(Icons.Star, { className: "w-6 h-6 text-amber-400 fill-current" }),
              React.createElement('p', { className: "text-2xl font-bold text-slate-800" }, "4.4")
            )
          ),
          React.createElement('div', { className: "bg-white rounded-xl border border-amber-200 p-4" },
            React.createElement('p', { className: "text-sm text-amber-600" }, "Pending Reviews"),
            React.createElement('p', { className: "text-2xl font-bold text-amber-600" }, "2")
          )
        ),
        React.createElement('div', { className: "bg-gradient-to-r from-orange-500 to-amber-500 rounded-xl p-6 text-white" },
          React.createElement('h3', { className: "text-xl font-bold" }, "Referral Program Active"),
          React.createElement('p', { className: "text-white/80" }, "Customers earn $100 credit for each successful referral"),
          React.createElement('div', { className: "mt-4 bg-white/20 px-4 py-2 rounded-lg inline-block" },
            React.createElement('span', { className: "font-mono" }, "refer.tradeos.com/yourcompany")
          )
        )
      );
    };

    const ServiceAgreements = () => {
      const plans = [
        { name: 'Bronze Care', price: 12.99, visits: 1, discount: 10 },
        { name: 'Silver Care', price: 19.99, visits: 2, discount: 15 },
        { name: 'Gold Care', price: 29.99, visits: 4, discount: 20 }
      ];

      return React.createElement('div', { className: "space-y-6" },
        React.createElement('h1', { className: "text-2xl font-bold text-slate-800" }, "Service Agreements"),
        React.createElement('p', { className: "text-slate-500" }, "Membership plans and recurring revenue"),
        React.createElement('div', { className: "grid grid-cols-1 md:grid-cols-4 gap-4" },
          React.createElement('div', { className: "bg-white rounded-xl border p-4" },
            React.createElement('p', { className: "text-sm text-slate-500" }, "Active Agreements"),
            React.createElement('p', { className: "text-2xl font-bold text-slate-800" }, "47")
          ),
          React.createElement('div', { className: "bg-white rounded-xl border border-green-200 p-4" },
            React.createElement('p', { className: "text-sm text-green-600" }, "Monthly Recurring"),
            React.createElement('p', { className: "text-2xl font-bold text-green-600" }, "$892.53")
          ),
          React.createElement('div', { className: "bg-white rounded-xl border border-amber-200 p-4" },
            React.createElement('p', { className: "text-sm text-amber-600" }, "Expiring Soon"),
            React.createElement('p', { className: "text-2xl font-bold text-amber-600" }, "5")
          ),
          React.createElement('div', { className: "bg-white rounded-xl border p-4" },
            React.createElement('p', { className: "text-sm text-slate-500" }, "Equipment Tracked"),
            React.createElement('p', { className: "text-2xl font-bold text-slate-800" }, "124")
          )
        ),
        React.createElement('div', { className: "grid grid-cols-1 md:grid-cols-3 gap-6" },
          plans.map((plan, i) =>
            React.createElement('div', { key: i, className: `bg-white rounded-xl border-2 ${i === 2 ? 'border-yellow-400' : 'border-slate-200'} overflow-hidden` },
              React.createElement('div', { className: `p-4 ${i === 0 ? 'bg-amber-100' : i === 1 ? 'bg-slate-200' : 'bg-yellow-100'}` },
                React.createElement('h3', { className: "text-xl font-bold text-slate-800" }, plan.name),
                React.createElement('div', { className: "mt-2" },
                  React.createElement('span', { className: "text-3xl font-bold text-slate-800" }, "$", plan.price),
                  React.createElement('span', { className: "text-slate-500" }, "/mo")
                )
              ),
              React.createElement('div', { className: "p-4" },
                React.createElement('ul', { className: "space-y-2 text-sm text-slate-600" },
                  React.createElement('li', null, React.createElement(Icons.CheckCircle, { className: "w-4 h-4 inline mr-2 text-green-500" }), plan.visits, " tune-up(s)/year"),
                  React.createElement('li', null, React.createElement(Icons.CheckCircle, { className: "w-4 h-4 inline mr-2 text-green-500" }), plan.discount, "% parts discount"),
                  React.createElement('li', null, React.createElement(Icons.CheckCircle, { className: "w-4 h-4 inline mr-2 text-green-500" }), "Priority scheduling")
                ),
                React.createElement('button', { className: "w-full mt-4 py-2 bg-orange-500 text-white rounded-lg hover:bg-orange-600" }, "Enroll Customer")
              )
            )
          )
        )
      );
    };

    const Team = () => {
      const employees = [
        { name: 'Mike Johnson', role: 'Field Tech', dept: 'HVAC', status: 'active', jobs: 847, rating: 4.9 },
        { name: 'Sarah Williams', role: 'Office', dept: 'Operations', status: 'active', jobs: 0, rating: 0 },
        { name: 'James Martinez', role: 'Field Tech', dept: 'Plumbing', status: 'active', jobs: 389, rating: 4.7 },
        { name: 'Emily Chen', role: 'Admin', dept: 'Management', status: 'active', jobs: 0, rating: 0 },
        { name: 'David Brown', role: 'Field Tech', dept: 'Electrical', status: 'on_leave', jobs: 156, rating: 4.8 }
      ];

      return React.createElement('div', { className: "space-y-6" },
        React.createElement('h1', { className: "text-2xl font-bold text-slate-800" }, "Team"),
        React.createElement('p', { className: "text-slate-500" }, "Employee management and HR"),
        React.createElement('div', { className: "grid grid-cols-1 md:grid-cols-4 gap-4" },
          React.createElement('div', { className: "bg-white rounded-xl border p-4" },
            React.createElement('p', { className: "text-sm text-slate-500" }, "Active Employees"),
            React.createElement('p', { className: "text-2xl font-bold text-slate-800" }, "4")
          ),
          React.createElement('div', { className: "bg-white rounded-xl border p-4" },
            React.createElement('p', { className: "text-sm text-slate-500" }, "Field Techs"),
            React.createElement('p', { className: "text-2xl font-bold text-slate-800" }, "3")
          ),
          React.createElement('div', { className: "bg-white rounded-xl border p-4" },
            React.createElement('p', { className: "text-sm text-slate-500" }, "Hours This Week"),
            React.createElement('p', { className: "text-2xl font-bold text-slate-800" }, "165")
          ),
          React.createElement('div', { className: "bg-white rounded-xl border border-amber-200 p-4" },
            React.createElement('p', { className: "text-sm text-amber-600" }, "Certs Expiring"),
            React.createElement('p', { className: "text-2xl font-bold text-amber-600" }, "2")
          )
        ),
        React.createElement('div', { className: "bg-white rounded-xl border overflow-hidden" },
          React.createElement('div', { className: "p-4 border-b" },
            React.createElement('h3', { className: "font-semibold text-slate-800" }, "Team Directory")
          ),
          React.createElement('div', { className: "divide-y" },
            employees.map((emp, i) =>
              React.createElement('div', { key: i, className: "p-4 flex items-center justify-between hover:bg-slate-50" },
                React.createElement('div', { className: "flex items-center gap-4" },
                  React.createElement('div', { className: "w-12 h-12 rounded-full bg-slate-200 flex items-center justify-center text-lg font-bold text-slate-600" }, emp.name.split(' ').map(n => n[0]).join('')),
                  React.createElement('div', null,
                    React.createElement('p', { className: "font-medium text-slate-800" }, emp.name),
                    React.createElement('p', { className: "text-sm text-slate-500" }, emp.dept)
                  )
                ),
                React.createElement('div', { className: "flex items-center gap-4" },
                  React.createElement('span', { className: `px-2 py-1 rounded-full text-xs font-medium ${emp.role === 'Admin' ? 'bg-purple-100 text-purple-700' : emp.role === 'Office' ? 'bg-blue-100 text-blue-700' : 'bg-green-100 text-green-700'}` }, emp.role),
                  React.createElement('span', { className: `px-2 py-1 rounded-full text-xs font-medium ${emp.status === 'active' ? 'bg-green-100 text-green-700' : 'bg-amber-100 text-amber-700'}` }, emp.status === 'active' ? 'Active' : 'On Leave'),
                  emp.role === 'Field Tech' && React.createElement('div', { className: "flex items-center gap-1" },
                    React.createElement(Icons.Star, { className: "w-4 h-4 text-amber-400 fill-current" }),
                    React.createElement('span', { className: "font-medium" }, emp.rating)
                  )
                )
              )
            )
          )
        )
      );
    };

    const Inventory = () => {
      const parts = [
        { sku: 'HVAC-CAP-35', name: 'Capacitor 35/5 MFD', qty: 24, cost: 12.50, price: 45.00, status: 'in_stock' },
        { sku: 'HVAC-CONT-24', name: 'Contactor 24V 30A', qty: 8, cost: 18.00, price: 65.00, status: 'low_stock' },
        { sku: 'PLMB-FLEX-12', name: 'Flex Supply Line 12"', qty: 3, cost: 6.50, price: 22.00, status: 'low_stock' },
        { sku: 'ELEC-OUTL-15', name: 'Outlet 15A Duplex', qty: 0, cost: 1.50, price: 8.00, status: 'out_of_stock' }
      ];

      return React.createElement('div', { className: "space-y-6" },
        React.createElement('h1', { className: "text-2xl font-bold text-slate-800" }, "Inventory"),
        React.createElement('p', { className: "text-slate-500" }, "Parts, stock, and purchase orders"),
        React.createElement('div', { className: "grid grid-cols-1 md:grid-cols-4 gap-4" },
          React.createElement('div', { className: "bg-white rounded-xl border p-4" },
            React.createElement('p', { className: "text-sm text-slate-500" }, "Total SKUs"),
            React.createElement('p', { className: "text-2xl font-bold text-slate-800" }, "8")
          ),
          React.createElement('div', { className: "bg-white rounded-xl border border-green-200 p-4" },
            React.createElement('p', { className: "text-sm text-green-600" }, "Inventory Value"),
            React.createElement('p', { className: "text-2xl font-bold text-green-600" }, "$2,847.50")
          ),
          React.createElement('div', { className: "bg-white rounded-xl border border-amber-200 p-4" },
            React.createElement('p', { className: "text-sm text-amber-600" }, "Low Stock"),
            React.createElement('p', { className: "text-2xl font-bold text-amber-600" }, "3")
          ),
          React.createElement('div', { className: "bg-white rounded-xl border p-4" },
            React.createElement('p', { className: "text-sm text-slate-500" }, "Pending POs"),
            React.createElement('p', { className: "text-2xl font-bold text-slate-800" }, "2")
          )
        ),
        React.createElement('div', { className: "bg-white rounded-xl border overflow-hidden" },
          React.createElement('table', { className: "w-full" },
            React.createElement('thead', { className: "bg-slate-50" },
              React.createElement('tr', null,
                React.createElement('th', { className: "px-4 py-3 text-left text-xs font-medium text-slate-500 uppercase" }, "Part"),
                React.createElement('th', { className: "px-4 py-3 text-left text-xs font-medium text-slate-500 uppercase" }, "SKU"),
                React.createElement('th', { className: "px-4 py-3 text-right text-xs font-medium text-slate-500 uppercase" }, "Cost"),
                React.createElement('th', { className: "px-4 py-3 text-right text-xs font-medium text-slate-500 uppercase" }, "Price"),
                React.createElement('th', { className: "px-4 py-3 text-right text-xs font-medium text-slate-500 uppercase" }, "Qty"),
                React.createElement('th', { className: "px-4 py-3 text-left text-xs font-medium text-slate-500 uppercase" }, "Status")
              )
            ),
            React.createElement('tbody', { className: "divide-y" },
              parts.map((p, i) =>
                React.createElement('tr', { key: i, className: "hover:bg-slate-50" },
                  React.createElement('td', { className: "px-4 py-4 font-medium text-slate-800" }, p.name),
                  React.createElement('td', { className: "px-4 py-4 font-mono text-sm text-slate-600" }, p.sku),
                  React.createElement('td', { className: "px-4 py-4 text-right text-slate-600" }, "$", p.cost.toFixed(2)),
                  React.createElement('td', { className: "px-4 py-4 text-right font-medium text-slate-800" }, "$", p.price.toFixed(2)),
                  React.createElement('td', { className: "px-4 py-4 text-right font-bold text-slate-800" }, p.qty),
                  React.createElement('td', { className: "px-4 py-4" },
                    React.createElement('span', { className: `px-2 py-1 rounded-full text-xs font-medium ${p.status === 'in_stock' ? 'bg-green-100 text-green-700' : p.status === 'low_stock' ? 'bg-amber-100 text-amber-700' : 'bg-red-100 text-red-700'}` }, p.status === 'in_stock' ? 'In Stock' : p.status === 'low_stock' ? 'Low' : 'Out')
                  )
                )
              )
            )
          )
        )
      );
    };

    const Remodeler = () => {
      const phases = [
        { name: 'Demo & Rough-In', status: 'completed', progress: 100 },
        { name: 'Plumbing Rough', status: 'completed', progress: 100 },
        { name: 'Electrical Rough', status: 'completed', progress: 100 },
        { name: 'Drywall & Paint', status: 'in_progress', progress: 60 },
        { name: 'Cabinetry Install', status: 'pending', progress: 0 },
        { name: 'Countertops', status: 'pending', progress: 0 },
        { name: 'Fixtures & Finish', status: 'pending', progress: 0 },
        { name: 'Final Inspection', status: 'pending', progress: 0 }
      ];

      return React.createElement('div', { className: "space-y-6" },
        React.createElement('h1', { className: "text-2xl font-bold text-slate-800" }, "Remodeler"),
        React.createElement('p', { className: "text-slate-500" }, "Project management for builders"),
        React.createElement('div', { className: "grid grid-cols-1 md:grid-cols-4 gap-4" },
          React.createElement('div', { className: "bg-white rounded-xl border p-4" },
            React.createElement('p', { className: "text-sm text-slate-500" }, "Contract Total"),
            React.createElement('p', { className: "text-2xl font-bold text-slate-800" }, "$89,500")
          ),
          React.createElement('div', { className: "bg-white rounded-xl border border-green-200 p-4" },
            React.createElement('p', { className: "text-sm text-green-600" }, "Amount Paid"),
            React.createElement('p', { className: "text-2xl font-bold text-green-600" }, "$59,500")
          ),
          React.createElement('div', { className: "bg-white rounded-xl border p-4" },
            React.createElement('p', { className: "text-sm text-slate-500" }, "Overall Progress"),
            React.createElement('p', { className: "text-2xl font-bold text-slate-800" }, "45%")
          ),
          React.createElement('div', { className: "bg-white rounded-xl border border-amber-200 p-4" },
            React.createElement('p', { className: "text-sm text-amber-600" }, "Change Orders"),
            React.createElement('p', { className: "text-2xl font-bold text-amber-600" }, "$4,500")
          )
        ),
        React.createElement('div', { className: "bg-white rounded-xl border p-6" },
          React.createElement('h2', { className: "text-xl font-bold text-slate-800 mb-2" }, "Johnson Kitchen & Bath Remodel"),
          React.createElement('p', { className: "text-slate-500 mb-6" }, "123 Oak St, Philadelphia, PA"),
          React.createElement('div', { className: "space-y-3" },
            phases.map((ph, i) =>
              React.createElement('div', { key: i, className: "flex items-center gap-4" },
                React.createElement('div', { className: "w-32 text-sm text-slate-700 truncate" }, ph.name),
                React.createElement('div', { className: "flex-1 h-3 bg-slate-100 rounded-full overflow-hidden" },
                  React.createElement('div', { className: `h-full rounded-full ${ph.status === 'completed' ? 'bg-green-500' : ph.status === 'in_progress' ? 'bg-blue-500' : 'bg-slate-300'}`, style: { width: `${ph.progress}%` } })
                ),
                React.createElement('div', { className: "w-12 text-right text-sm font-medium text-slate-600" }, ph.progress, "%")
              )
            )
          )
        )
      );
    };

    const SettingsPage = () => {
      return React.createElement('div', { className: "space-y-6" },
        React.createElement('h1', { className: "text-2xl font-bold text-slate-800" }, "Settings"),
        React.createElement('p', { className: "text-slate-500" }, "System configuration and preferences"),
        React.createElement('div', { className: "bg-white rounded-xl border p-6" },
          React.createElement('h2', { className: "font-semibold text-slate-800 mb-4" }, "Company Settings"),
          React.createElement('div', { className: "space-y-4" },
            React.createElement('div', null,
              React.createElement('label', { className: "block text-sm font-medium text-slate-700 mb-1" }, "Company Name"),
              React.createElement('input', { type: "text", defaultValue: "TradeOS Demo Company", className: "w-full px-4 py-2 border border-slate-200 rounded-lg" })
            ),
            React.createElement('div', null,
              React.createElement('label', { className: "block text-sm font-medium text-slate-700 mb-1" }, "Email"),
              React.createElement('input', { type: "email", defaultValue: "admin@tradeos.demo", className: "w-full px-4 py-2 border border-slate-200 rounded-lg" })
            )
          )
        )
      );
    };

    // ============================================================
    // APP SHELL - Main Layout
    // ============================================================
    const AppShell = ({ children, currentPage, onNavigate, onLogout }) => {
      const { role, setRole } = useKernel();
      const [sidebarOpen, setSidebarOpen] = useState(true);
      const [mobileMenuOpen, setMobileMenuOpen] = useState(false);
      const [userMenuOpen, setUserMenuOpen] = useState(false);

      const navigation = {
        admin: [
          { id: 'dashboard', label: 'Dashboard', icon: Icons.LayoutDashboard },
          { id: 'crm', label: 'CRM', icon: Icons.Target },
          { id: 'marketing', label: 'Marketing', icon: Icons.Megaphone },
          { id: 'agreements', label: 'Agreements', icon: Icons.FileText },
          { id: 'team', label: 'Team', icon: Icons.UserCog },
          { id: 'inventory', label: 'Inventory', icon: Icons.Package },
          { id: 'remodeler', label: 'Remodeler', icon: Icons.Building },
          { id: 'settings', label: 'Settings', icon: Icons.Settings }
        ],
        office: [
          { id: 'dashboard', label: 'Dashboard', icon: Icons.LayoutDashboard },
          { id: 'crm', label: 'CRM', icon: Icons.Target },
          { id: 'marketing', label: 'Marketing', icon: Icons.Megaphone },
          { id: 'agreements', label: 'Agreements', icon: Icons.FileText },
          { id: 'inventory', label: 'Inventory', icon: Icons.Package },
          { id: 'remodeler', label: 'Remodeler', icon: Icons.Building }
        ],
        field_tech: [
          { id: 'dashboard', label: 'My Day', icon: Icons.LayoutDashboard },
          { id: 'inventory', label: 'Inventory', icon: Icons.Package }
        ],
        customer: [
          { id: 'dashboard', label: 'Home', icon: Icons.LayoutDashboard },
          { id: 'agreements', label: 'My Agreements', icon: Icons.FileText }
        ]
      };

      const navItems = navigation[role] || navigation.customer;
      const roleLabels = { admin: 'Administrator', office: 'Office Staff', field_tech: 'Field Technician', customer: 'Customer' };
      const roleColors = { admin: 'bg-red-600', office: 'bg-blue-600', field_tech: 'bg-green-600', customer: 'bg-purple-600' };

      return React.createElement('div', { className: "min-h-screen bg-slate-50" },
        // Top Bar
        React.createElement('header', { className: "fixed top-0 left-0 right-0 h-16 bg-white border-b border-slate-200 z-50 flex items-center justify-between px-4" },
          React.createElement('div', { className: "flex items-center gap-4" },
            React.createElement('button', { onClick: () => setSidebarOpen(!sidebarOpen), className: "hidden lg:flex p-2 hover:bg-slate-100 rounded-lg" },
              React.createElement(Icons.Menu, { className: "w-5 h-5 text-slate-600" })
            ),
            React.createElement('button', { onClick: () => setMobileMenuOpen(!mobileMenuOpen), className: "lg:hidden p-2 hover:bg-slate-100 rounded-lg" },
              mobileMenuOpen ? React.createElement(Icons.X, { className: "w-5 h-5" }) : React.createElement(Icons.Menu, { className: "w-5 h-5" })
            ),
            React.createElement('div', { className: "flex items-center gap-2" },
              React.createElement('div', { className: "w-8 h-8 bg-gradient-to-br from-orange-500 to-red-600 rounded-lg flex items-center justify-center" },
                React.createElement('span', { className: "text-white font-bold text-sm" }, "T")
              ),
              React.createElement('span', { className: "font-semibold text-slate-800 text-lg" }, "TradeOS")
            )
          ),
          React.createElement('div', { className: "flex items-center gap-3" },
            React.createElement('div', { className: "hidden md:flex items-center gap-2 px-3 py-1.5 bg-green-50 border border-green-200 rounded-full" },
              React.createElement(Icons.Shield, { className: "w-4 h-4 text-green-600" }),
              React.createElement('span', { className: "text-xs text-green-700 font-medium" }, "L1 Kernel Active")
            ),
            React.createElement('button', { className: "p-2 hover:bg-slate-100 rounded-lg relative" },
              React.createElement(Icons.Bell, { className: "w-5 h-5 text-slate-600" }),
              React.createElement('span', { className: "absolute top-1 right-1 w-2 h-2 bg-red-500 rounded-full" })
            ),
            React.createElement('div', { className: "relative" },
              React.createElement('button', { onClick: () => setUserMenuOpen(!userMenuOpen), className: "flex items-center gap-2 p-2 hover:bg-slate-100 rounded-lg" },
                React.createElement('div', { className: `w-8 h-8 ${roleColors[role]} rounded-full flex items-center justify-center` },
                  React.createElement(Icons.User, { className: "w-4 h-4 text-white" })
                ),
                React.createElement('div', { className: "hidden md:block text-left" },
                  React.createElement('div', { className: "text-sm font-medium text-slate-800" }, "Demo User"),
                  React.createElement('div', { className: "text-xs text-slate-500" }, roleLabels[role])
                ),
                React.createElement(Icons.ChevronDown, { className: "w-4 h-4 text-slate-400" })
              ),
              userMenuOpen && React.createElement('div', { className: "absolute right-0 top-full mt-2 w-64 bg-white border border-slate-200 rounded-lg shadow-lg py-2 z-50" },
                React.createElement('div', { className: "px-4 py-2 border-b border-slate-100" },
                  React.createElement('div', { className: "text-xs text-slate-500 mb-2" }, "Switch Role (Demo)"),
                  Object.keys(roleLabels).map(r =>
                    React.createElement('button', { key: r, onClick: () => { setRole(r); setUserMenuOpen(false); }, className: `w-full text-left px-3 py-2 rounded-lg text-sm flex items-center gap-2 ${role === r ? 'bg-slate-100 font-medium' : 'hover:bg-slate-50'}` },
                      React.createElement('div', { className: `w-3 h-3 ${roleColors[r]} rounded-full` }),
                      roleLabels[r]
                    )
                  )
                ),
                React.createElement('button', { onClick: onLogout, className: "w-full text-left px-4 py-2 text-sm text-slate-600 hover:bg-slate-50 flex items-center gap-2" },
                  React.createElement(Icons.LogOut, { className: "w-4 h-4" }), "Sign Out"
                )
              )
            )
          )
        ),
        // Mobile Menu
        mobileMenuOpen && React.createElement('div', { className: "fixed inset-0 top-16 bg-white z-40 lg:hidden overflow-y-auto" },
          React.createElement('nav', { className: "p-4 space-y-1" },
            navItems.map(item =>
              React.createElement('button', { key: item.id, onClick: () => { onNavigate(item.id); setMobileMenuOpen(false); }, className: `w-full flex items-center gap-3 px-4 py-3 rounded-lg text-left ${currentPage === item.id ? 'bg-orange-50 text-orange-700 font-medium' : 'text-slate-600 hover:bg-slate-50'}` },
                React.createElement(item.icon, { className: "w-5 h-5" }),
                item.label
              )
            )
          )
        ),
        // Sidebar
        React.createElement('aside', { className: `fixed top-16 left-0 bottom-0 bg-white border-r border-slate-200 transition-all duration-200 z-30 hidden lg:block ${sidebarOpen ? 'w-64' : 'w-20'}` },
          React.createElement('nav', { className: "p-4 space-y-1" },
            navItems.map(item =>
              React.createElement('button', { key: item.id, onClick: () => onNavigate(item.id), title: !sidebarOpen ? item.label : undefined, className: `w-full flex items-center gap-3 px-4 py-3 rounded-lg text-left ${currentPage === item.id ? 'bg-orange-50 text-orange-700 font-medium' : 'text-slate-600 hover:bg-slate-50'}` },
                React.createElement(item.icon, { className: "w-5 h-5 flex-shrink-0" }),
                sidebarOpen && React.createElement('span', null, item.label)
              )
            )
          )
        ),
        // Main Content
        React.createElement('main', { className: `pt-16 transition-all duration-200 ${sidebarOpen ? 'lg:pl-64' : 'lg:pl-20'}` },
          React.createElement('div', { className: "p-6" }, children)
        )
      );
    };

    // ============================================================
    // MAIN APP
    // ============================================================
    const App = () => {
      const [isLoggedIn, setIsLoggedIn] = useState(false);
      const [currentRole, setCurrentRole] = useState('customer');
      const [currentPage, setCurrentPage] = useState('dashboard');

      const handleLogin = (role) => {
        setCurrentRole(role);
        setIsLoggedIn(true);
        setCurrentPage('dashboard');
      };

      const handleLogout = () => {
        setIsLoggedIn(false);
        setCurrentRole('customer');
      };

      const renderPage = () => {
        switch (currentPage) {
          case 'dashboard': return React.createElement(Dashboard);
          case 'crm': return React.createElement(CRM);
          case 'marketing': return React.createElement(Marketing);
          case 'agreements': return React.createElement(ServiceAgreements);
          case 'team': return React.createElement(Team);
          case 'inventory': return React.createElement(Inventory);
          case 'remodeler': return React.createElement(Remodeler);
          case 'settings': return React.createElement(SettingsPage);
          default: return React.createElement(Dashboard);
        }
      };

      return React.createElement(AuthProvider, null,
        React.createElement(KernelProvider, { boundaries: TRADEOS_BOUNDARIES, initialRole: currentRole },
          !isLoggedIn
            ? React.createElement(LoginPage, { onLogin: handleLogin })
            : React.createElement(AppShell, {
                currentPage,
                onNavigate: setCurrentPage,
                onLogout: handleLogout
              }, renderPage())
        )
      );
    };

    // Mount the app
    const root = ReactDOM.createRoot(document.getElementById('root'));
    root.render(React.createElement(App));
  </script>
</body>
</html>
