{
  "_lds": {
    "uuid": "tradeos-marketing-2026-001",
    "type": "ui_component",
    "version": "1.0.0",
    "created": "2026-01-14T03:15:00Z",
    "parent": "tradeos-master-2026-001",
    "phase": 5,
    "sequence": 2
  },
  "core": {
    "name": "TradeOS Marketing",
    "description": "Campaign management, review aggregation, referral tracking, and promotional calendar.",
    "principle": "Admin can campaign:create, campaign:delete. Office can campaign:send. Review responses require approval."
  },
  "features": {
    "campaign_management": "Email, direct mail, digital campaign creation and tracking",
    "review_aggregation": "Aggregate reviews from Google, Yelp, Facebook, HomeAdvisor",
    "referral_program": "Track referrals with reward management",
    "promotion_calendar": "Seasonal promotions with codes and usage tracking",
    "roi_tracking": "Campaign ROI and conversion metrics"
  },
  "react_component": {
    "filename": "Marketing.tsx",
    "code": "import React, { useState, useCallback } from 'react';\nimport { Megaphone, Mail, Star, Users, Calendar, Plus, Send, X, Gift, MessageSquare, Check, Copy, Sparkles, TrendingUp, DollarSign, Eye, Filter, BarChart3, ExternalLink } from 'lucide-react';\nimport { useKernel } from './LDSKernel';\n\ntype CampaignType = 'email' | 'direct_mail' | 'digital' | 'sms';\ntype CampaignStatus = 'draft' | 'scheduled' | 'active' | 'completed';\ntype ReviewPlatform = 'google' | 'yelp' | 'facebook' | 'homeadvisor';\n\ninterface Campaign {\n  id: string;\n  name: string;\n  type: CampaignType;\n  status: CampaignStatus;\n  startDate: string;\n  endDate?: string;\n  audience: string;\n  audienceSize: number;\n  sent: number;\n  opened: number;\n  clicked: number;\n  converted: number;\n  revenue: number;\n  cost: number;\n}\n\ninterface Review {\n  id: string;\n  platform: ReviewPlatform;\n  customerName: string;\n  rating: number;\n  date: string;\n  text: string;\n  responded: boolean;\n  response?: string;\n}\n\ninterface Referral {\n  id: string;\n  referrerName: string;\n  referrerEmail: string;\n  referredName: string;\n  referredEmail: string;\n  status: 'pending' | 'converted' | 'expired';\n  createdDate: string;\n  convertedDate?: string;\n  jobValue?: number;\n  rewardAmount: number;\n  rewardPaid: boolean;\n}\n\ninterface Promotion {\n  id: string;\n  name: string;\n  description: string;\n  startDate: string;\n  endDate: string;\n  discount: string;\n  code?: string;\n  usageCount: number;\n  revenue: number;\n}\n\nconst CAMPAIGNS: Campaign[] = [\n  { id: 'c1', name: 'Winter Heating Checkup', type: 'email', status: 'active', startDate: '2026-01-01', endDate: '2026-01-31', audience: 'All Customers', audienceSize: 2450, sent: 2450, opened: 892, clicked: 234, converted: 42, revenue: 18500, cost: 250 },\n  { id: 'c2', name: 'New Year Special', type: 'email', status: 'completed', startDate: '2025-12-26', endDate: '2026-01-05', audience: 'Inactive 6+ months', audienceSize: 890, sent: 890, opened: 312, clicked: 89, converted: 15, revenue: 8200, cost: 100 },\n  { id: 'c3', name: 'Spring AC Prep Mailer', type: 'direct_mail', status: 'scheduled', startDate: '2026-03-01', audience: 'HVAC Customers', audienceSize: 1200, sent: 0, opened: 0, clicked: 0, converted: 0, revenue: 0, cost: 1800 },\n  { id: 'c4', name: 'Review Request Auto', type: 'email', status: 'active', startDate: '2025-06-01', audience: 'Post-Job (Auto)', audienceSize: 0, sent: 4567, opened: 2890, clicked: 1245, converted: 456, revenue: 0, cost: 0 },\n  { id: 'c5', name: 'Facebook Spring Ads', type: 'digital', status: 'draft', startDate: '2026-03-15', audience: 'Local Homeowners', audienceSize: 50000, sent: 0, opened: 0, clicked: 0, converted: 0, revenue: 0, cost: 2500 }\n];\n\nconst REVIEWS: Review[] = [\n  { id: 'r1', platform: 'google', customerName: 'Sarah M.', rating: 5, date: '2026-01-13', text: 'Excellent service! Mike was professional and fixed our heating issue quickly.', responded: true, response: 'Thank you Sarah! It was our pleasure serving you!' },\n  { id: 'r2', platform: 'yelp', customerName: 'John D.', rating: 4, date: '2026-01-12', text: 'Good work but had to wait a bit longer than expected for the appointment.', responded: false },\n  { id: 'r3', platform: 'google', customerName: 'Lisa K.', rating: 5, date: '2026-01-11', text: 'Best HVAC company in Philly! Fair prices and great customer service.', responded: true, response: 'Thank you Lisa! We strive for excellence.' },\n  { id: 'r4', platform: 'facebook', customerName: 'Robert P.', rating: 3, date: '2026-01-10', text: 'Work was done correctly but communication could have been better.', responded: false },\n  { id: 'r5', platform: 'homeadvisor', customerName: 'Maria G.', rating: 5, date: '2026-01-09', text: 'Installed our new water heater perfectly! Very happy.', responded: true, response: 'Enjoy your new water heater Maria!' }\n];\n\nconst REFERRALS: Referral[] = [\n  { id: 'ref1', referrerName: 'Johnson Family', referrerEmail: 'johnson@email.com', referredName: 'Thompson Residence', referredEmail: 'thompson@email.com', status: 'converted', createdDate: '2026-01-10', convertedDate: '2026-01-13', jobValue: 8500, rewardAmount: 100, rewardPaid: false },\n  { id: 'ref2', referrerName: 'Smith Commercial', referrerEmail: 'smith@company.com', referredName: 'Chen Office', referredEmail: 'chen@company.com', status: 'pending', createdDate: '2026-01-12', rewardAmount: 100, rewardPaid: false },\n  { id: 'ref3', referrerName: 'Davis Home', referrerEmail: 'davis@email.com', referredName: 'Wilson Property', referredEmail: 'wilson@email.com', status: 'converted', createdDate: '2026-01-05', convertedDate: '2026-01-08', jobValue: 3200, rewardAmount: 100, rewardPaid: true }\n];\n\nconst PROMOTIONS: Promotion[] = [\n  { id: 'p1', name: 'Winter Tune-Up Special', description: '$50 off any heating system tune-up', startDate: '2026-01-01', endDate: '2026-02-28', discount: '$50 off', code: 'WINTER50', usageCount: 28, revenue: 5572 },\n  { id: 'p2', name: 'Referral Reward', description: '$100 credit for successful referrals', startDate: '2025-01-01', endDate: '2026-12-31', discount: '$100 credit', usageCount: 156, revenue: 234000 },\n  { id: 'p3', name: 'Spring AC Check', description: 'Free AC inspection with any service', startDate: '2026-03-01', endDate: '2026-05-31', discount: 'Free inspection', code: 'SPRINGAC', usageCount: 0, revenue: 0 }\n];\n\nconst TYPE_CONFIG: Record<CampaignType, { label: string; color: string }> = {\n  email: { label: 'Email', color: 'text-blue-600 bg-blue-100' },\n  direct_mail: { label: 'Direct Mail', color: 'text-amber-600 bg-amber-100' },\n  digital: { label: 'Digital Ads', color: 'text-purple-600 bg-purple-100' },\n  sms: { label: 'SMS', color: 'text-green-600 bg-green-100' }\n};\n\nconst STATUS_CONFIG: Record<CampaignStatus, { label: string; color: string }> = {\n  draft: { label: 'Draft', color: 'text-slate-600 bg-slate-100' },\n  scheduled: { label: 'Scheduled', color: 'text-blue-600 bg-blue-100' },\n  active: { label: 'Active', color: 'text-green-600 bg-green-100' },\n  completed: { label: 'Completed', color: 'text-slate-600 bg-slate-100' }\n};\n\nconst PLATFORM_CONFIG: Record<ReviewPlatform, { label: string; color: string }> = {\n  google: { label: 'Google', color: 'text-blue-600' },\n  yelp: { label: 'Yelp', color: 'text-red-600' },\n  facebook: { label: 'Facebook', color: 'text-indigo-600' },\n  homeadvisor: { label: 'HomeAdvisor', color: 'text-orange-600' }\n};\n\ntype ViewMode = 'campaigns' | 'reviews' | 'referrals' | 'promotions';\n\nexport const Marketing: React.FC = () => {\n  const { validate, role } = useKernel();\n  const [viewMode, setViewMode] = useState<ViewMode>('campaigns');\n  const [campaigns, setCampaigns] = useState<Campaign[]>(CAMPAIGNS);\n  const [reviews, setReviews] = useState<Review[]>(REVIEWS);\n  const [showCreate, setShowCreate] = useState(false);\n  const [showRespond, setShowRespond] = useState<Review | null>(null);\n  const [responseText, setResponseText] = useState('');\n\n  const handleCreateCampaign = useCallback(() => {\n    const result = validate('campaign:create', { authenticated: true, mfa_verified: true });\n    if (result.result !== 'ALLOWED') {\n      alert(`Create denied: ${result.reason}`);\n      return;\n    }\n    setShowCreate(true);\n  }, [validate]);\n\n  const handleSendCampaign = useCallback((id: string) => {\n    const result = validate('campaign:send', { authenticated: true });\n    if (result.result !== 'ALLOWED') {\n      alert(`Send denied: ${result.reason}`);\n      return;\n    }\n    setCampaigns(prev => prev.map(c => c.id === id ? { ...c, status: 'active' as CampaignStatus } : c));\n    alert('Campaign launched!');\n  }, [validate]);\n\n  const handleRespond = useCallback(() => {\n    if (!showRespond || !responseText.trim()) return;\n    setReviews(prev => prev.map(r => r.id === showRespond.id ? { ...r, responded: true, response: responseText } : r));\n    setShowRespond(null);\n    setResponseText('');\n    alert('Response submitted!');\n  }, [showRespond, responseText]);\n\n  const totalSent = campaigns.reduce((s, c) => s + c.sent, 0);\n  const totalRevenue = campaigns.reduce((s, c) => s + c.revenue, 0);\n  const avgRating = reviews.reduce((s, r) => s + r.rating, 0) / reviews.length;\n  const pendingReviews = reviews.filter(r => !r.responded).length;\n  const pendingReferrals = REFERRALS.filter(r => r.status === 'pending').length;\n\n  const CampaignsView = () => (\n    <div className=\"space-y-6\">\n      <div className=\"grid grid-cols-2 md:grid-cols-4 gap-4\">\n        <div className=\"bg-white rounded-xl border border-slate-200 p-4\">\n          <p className=\"text-sm text-slate-500\">Emails Sent (MTD)</p>\n          <p className=\"text-2xl font-bold text-slate-800\">{totalSent.toLocaleString()}</p>\n        </div>\n        <div className=\"bg-white rounded-xl border border-green-200 p-4\">\n          <p className=\"text-sm text-green-600\">Campaign Revenue</p>\n          <p className=\"text-2xl font-bold text-green-600\">${totalRevenue.toLocaleString()}</p>\n        </div>\n        <div className=\"bg-white rounded-xl border border-slate-200 p-4\">\n          <p className=\"text-sm text-slate-500\">Active Campaigns</p>\n          <p className=\"text-2xl font-bold text-slate-800\">{campaigns.filter(c => c.status === 'active').length}</p>\n        </div>\n        <div className=\"bg-white rounded-xl border border-slate-200 p-4\">\n          <p className=\"text-sm text-slate-500\">Avg Open Rate</p>\n          <p className=\"text-2xl font-bold text-slate-800\">36%</p>\n        </div>\n      </div>\n\n      <div className=\"bg-white rounded-xl border border-slate-200 overflow-hidden\">\n        <div className=\"p-4 border-b border-slate-100 flex items-center justify-between\">\n          <h3 className=\"font-semibold text-slate-800\">Campaigns</h3>\n          {role === 'admin' && (\n            <button onClick={handleCreateCampaign} className=\"px-4 py-2 bg-orange-500 text-white rounded-lg hover:bg-orange-600 flex items-center gap-2\">\n              <Plus className=\"w-4 h-4\" /> New Campaign\n            </button>\n          )}\n        </div>\n        <div className=\"divide-y divide-slate-100\">\n          {campaigns.map((c) => {\n            const typeConf = TYPE_CONFIG[c.type];\n            const statusConf = STATUS_CONFIG[c.status];\n            const openRate = c.sent > 0 ? ((c.opened / c.sent) * 100).toFixed(1) : '0';\n            const clickRate = c.opened > 0 ? ((c.clicked / c.opened) * 100).toFixed(1) : '0';\n            return (\n              <div key={c.id} className=\"p-4 hover:bg-slate-50\">\n                <div className=\"flex items-start justify-between mb-3\">\n                  <div className=\"flex items-center gap-3\">\n                    <div className={`p-2 rounded-lg ${typeConf.color}`}>\n                      {c.type === 'email' ? <Mail className=\"w-4 h-4\" /> : c.type === 'digital' ? <Megaphone className=\"w-4 h-4\" /> : <Mail className=\"w-4 h-4\" />}\n                    </div>\n                    <div>\n                      <p className=\"font-medium text-slate-800\">{c.name}</p>\n                      <p className=\"text-sm text-slate-500\">{c.audience} â€¢ {c.audienceSize.toLocaleString()} recipients</p>\n                    </div>\n                  </div>\n                  <div className=\"flex items-center gap-2\">\n                    <span className={`px-2 py-1 rounded-full text-xs font-medium ${statusConf.color}`}>{statusConf.label}</span>\n                    {c.status === 'draft' && (\n                      <button onClick={() => handleSendCampaign(c.id)} className=\"p-2 text-blue-600 hover:bg-blue-50 rounded-lg\"><Send className=\"w-4 h-4\" /></button>\n                    )}\n                  </div>\n                </div>\n                <div className=\"grid grid-cols-2 md:grid-cols-6 gap-4 text-sm\">\n                  <div><p className=\"text-slate-500\">Sent</p><p className=\"font-medium text-slate-800\">{c.sent.toLocaleString()}</p></div>\n                  <div><p className=\"text-slate-500\">Opened</p><p className=\"font-medium text-slate-800\">{c.opened.toLocaleString()} ({openRate}%)</p></div>\n                  <div><p className=\"text-slate-500\">Clicked</p><p className=\"font-medium text-slate-800\">{c.clicked.toLocaleString()} ({clickRate}%)</p></div>\n                  <div><p className=\"text-slate-500\">Converted</p><p className=\"font-medium text-slate-800\">{c.converted}</p></div>\n                  <div><p className=\"text-slate-500\">Revenue</p><p className=\"font-medium text-green-600\">${c.revenue.toLocaleString()}</p></div>\n                  <div><p className=\"text-slate-500\">ROI</p><p className={`font-medium ${c.cost > 0 && c.revenue > 0 ? 'text-green-600' : 'text-slate-800'}`}>{c.cost > 0 && c.revenue > 0 ? `${((c.revenue - c.cost) / c.cost * 100).toFixed(0)}%` : '-'}</p></div>\n                </div>\n              </div>\n            );\n          })}\n        </div>\n      </div>\n    </div>\n  );\n\n  const ReviewsView = () => (\n    <div className=\"space-y-6\">\n      <div className=\"grid grid-cols-2 md:grid-cols-4 gap-4\">\n        <div className=\"bg-white rounded-xl border border-slate-200 p-4\">\n          <p className=\"text-sm text-slate-500\">Average Rating</p>\n          <div className=\"flex items-center gap-2\"><Star className=\"w-6 h-6 text-amber-400 fill-current\" /><p className=\"text-2xl font-bold text-slate-800\">{avgRating.toFixed(1)}</p></div>\n        </div>\n        <div className=\"bg-white rounded-xl border border-slate-200 p-4\">\n          <p className=\"text-sm text-slate-500\">Total Reviews</p>\n          <p className=\"text-2xl font-bold text-slate-800\">{reviews.length}</p>\n        </div>\n        <div className=\"bg-white rounded-xl border border-amber-200 p-4\">\n          <p className=\"text-sm text-amber-600\">Needs Response</p>\n          <p className=\"text-2xl font-bold text-amber-600\">{pendingReviews}</p>\n        </div>\n        <div className=\"bg-white rounded-xl border border-green-200 p-4\">\n          <p className=\"text-sm text-green-600\">Response Rate</p>\n          <p className=\"text-2xl font-bold text-green-600\">{((reviews.filter(r => r.responded).length / reviews.length) * 100).toFixed(0)}%</p>\n        </div>\n      </div>\n\n      <div className=\"bg-white rounded-xl border border-slate-200\">\n        <div className=\"p-4 border-b border-slate-100 flex items-center justify-between\">\n          <h3 className=\"font-semibold text-slate-800\">Recent Reviews</h3>\n          <select className=\"px-3 py-2 border border-slate-200 rounded-lg text-sm\">\n            <option>All Platforms</option><option>Google</option><option>Yelp</option><option>Facebook</option><option>HomeAdvisor</option>\n          </select>\n        </div>\n        <div className=\"divide-y divide-slate-100\">\n          {reviews.map((r) => (\n            <div key={r.id} className=\"p-4\">\n              <div className=\"flex items-start justify-between mb-2\">\n                <div className=\"flex items-center gap-3\">\n                  <div className=\"w-10 h-10 rounded-full bg-slate-100 flex items-center justify-center font-medium text-slate-600\">{r.customerName.charAt(0)}</div>\n                  <div>\n                    <div className=\"flex items-center gap-2\">\n                      <p className=\"font-medium text-slate-800\">{r.customerName}</p>\n                      <span className={`text-sm ${PLATFORM_CONFIG[r.platform].color}`}>{PLATFORM_CONFIG[r.platform].label}</span>\n                    </div>\n                    <div className=\"flex items-center gap-1\">\n                      {[1,2,3,4,5].map((s) => (<Star key={s} className={`w-4 h-4 ${s <= r.rating ? 'text-amber-400 fill-current' : 'text-slate-200'}`} />))}\n                      <span className=\"text-sm text-slate-400 ml-2\">{r.date}</span>\n                    </div>\n                  </div>\n                </div>\n                {!r.responded && (<button onClick={() => setShowRespond(r)} className=\"px-3 py-1.5 bg-orange-100 text-orange-700 rounded-lg hover:bg-orange-200 text-sm font-medium\">Respond</button>)}\n              </div>\n              <p className=\"text-slate-700 mb-3\">\"{r.text}\"</p>\n              {r.responded && r.response && (\n                <div className=\"pl-4 border-l-2 border-green-200 bg-green-50 p-3 rounded-r-lg\">\n                  <div className=\"flex items-center gap-2 mb-1\"><Check className=\"w-4 h-4 text-green-600\" /><span className=\"text-sm font-medium text-green-700\">Your Response</span></div>\n                  <p className=\"text-sm text-green-800\">{r.response}</p>\n                </div>\n              )}\n            </div>\n          ))}\n        </div>\n      </div>\n    </div>\n  );\n\n  const ReferralsView = () => (\n    <div className=\"space-y-6\">\n      <div className=\"grid grid-cols-2 md:grid-cols-4 gap-4\">\n        <div className=\"bg-white rounded-xl border border-slate-200 p-4\">\n          <p className=\"text-sm text-slate-500\">Total Referrals</p>\n          <p className=\"text-2xl font-bold text-slate-800\">{REFERRALS.length}</p>\n        </div>\n        <div className=\"bg-white rounded-xl border border-green-200 p-4\">\n          <p className=\"text-sm text-green-600\">Converted</p>\n          <p className=\"text-2xl font-bold text-green-600\">{REFERRALS.filter(r => r.status === 'converted').length}</p>\n        </div>\n        <div className=\"bg-white rounded-xl border border-amber-200 p-4\">\n          <p className=\"text-sm text-amber-600\">Pending</p>\n          <p className=\"text-2xl font-bold text-amber-600\">{pendingReferrals}</p>\n        </div>\n        <div className=\"bg-white rounded-xl border border-slate-200 p-4\">\n          <p className=\"text-sm text-slate-500\">Revenue from Referrals</p>\n          <p className=\"text-2xl font-bold text-slate-800\">${REFERRALS.filter(r => r.jobValue).reduce((s, r) => s + (r.jobValue || 0), 0).toLocaleString()}</p>\n        </div>\n      </div>\n\n      <div className=\"bg-gradient-to-r from-orange-500 to-amber-500 rounded-xl p-6 text-white\">\n        <div className=\"flex items-center gap-4\">\n          <div className=\"p-3 bg-white/20 rounded-xl\"><Gift className=\"w-8 h-8\" /></div>\n          <div>\n            <h3 className=\"text-xl font-bold\">Referral Program</h3>\n            <p className=\"text-white/80\">Customers earn $100 credit for each successful referral</p>\n          </div>\n        </div>\n        <div className=\"mt-4 flex items-center gap-4\">\n          <div className=\"bg-white/20 px-4 py-2 rounded-lg\">\n            <p className=\"text-sm text-white/80\">Referral Link</p>\n            <p className=\"font-mono\">refer.tradeos.com/yourcompany</p>\n          </div>\n          <button className=\"p-2 bg-white/20 rounded-lg hover:bg-white/30\"><Copy className=\"w-5 h-5\" /></button>\n        </div>\n      </div>\n\n      <div className=\"bg-white rounded-xl border border-slate-200 overflow-hidden\">\n        <div className=\"p-4 border-b border-slate-100\"><h3 className=\"font-semibold text-slate-800\">Recent Referrals</h3></div>\n        <table className=\"w-full\">\n          <thead className=\"bg-slate-50\">\n            <tr>\n              <th className=\"px-4 py-3 text-left text-xs font-medium text-slate-500 uppercase\">Referrer</th>\n              <th className=\"px-4 py-3 text-left text-xs font-medium text-slate-500 uppercase\">Referred</th>\n              <th className=\"px-4 py-3 text-left text-xs font-medium text-slate-500 uppercase\">Date</th>\n              <th className=\"px-4 py-3 text-left text-xs font-medium text-slate-500 uppercase\">Status</th>\n              <th className=\"px-4 py-3 text-right text-xs font-medium text-slate-500 uppercase\">Job Value</th>\n              <th className=\"px-4 py-3 text-right text-xs font-medium text-slate-500 uppercase\">Reward</th>\n            </tr>\n          </thead>\n          <tbody className=\"divide-y divide-slate-100\">\n            {REFERRALS.map((ref) => (\n              <tr key={ref.id} className=\"hover:bg-slate-50\">\n                <td className=\"px-4 py-4\"><p className=\"font-medium text-slate-800\">{ref.referrerName}</p><p className=\"text-sm text-slate-500\">{ref.referrerEmail}</p></td>\n                <td className=\"px-4 py-4\"><p className=\"font-medium text-slate-800\">{ref.referredName}</p><p className=\"text-sm text-slate-500\">{ref.referredEmail}</p></td>\n                <td className=\"px-4 py-4 text-sm text-slate-600\">{ref.createdDate}</td>\n                <td className=\"px-4 py-4\"><span className={`px-2 py-1 rounded-full text-xs font-medium ${ref.status === 'converted' ? 'bg-green-100 text-green-700' : ref.status === 'pending' ? 'bg-amber-100 text-amber-700' : 'bg-slate-100 text-slate-600'}`}>{ref.status.charAt(0).toUpperCase() + ref.status.slice(1)}</span></td>\n                <td className=\"px-4 py-4 text-right font-medium text-slate-800\">{ref.jobValue ? `$${ref.jobValue.toLocaleString()}` : '-'}</td>\n                <td className=\"px-4 py-4 text-right\"><span className=\"font-medium text-slate-800\">${ref.rewardAmount}</span>{ref.status === 'converted' && (<span className={`text-xs ml-1 ${ref.rewardPaid ? 'text-green-600' : 'text-amber-600'}`}>{ref.rewardPaid ? '(Paid)' : '(Pending)'}</span>)}</td>\n              </tr>\n            ))}\n          </tbody>\n        </table>\n      </div>\n    </div>\n  );\n\n  const PromotionsView = () => (\n    <div className=\"space-y-6\">\n      <div className=\"bg-white rounded-xl border border-slate-200 p-6\">\n        <div className=\"flex items-center justify-between mb-4\">\n          <h3 className=\"font-semibold text-slate-800\">Promotion Calendar</h3>\n          {role === 'admin' && (<button className=\"px-4 py-2 bg-orange-500 text-white rounded-lg hover:bg-orange-600 flex items-center gap-2\"><Plus className=\"w-4 h-4\" /> New Promotion</button>)}\n        </div>\n        <div className=\"space-y-4\">\n          {PROMOTIONS.map((p) => {\n            const isActive = new Date(p.startDate) <= new Date() && new Date(p.endDate) >= new Date();\n            const isUpcoming = new Date(p.startDate) > new Date();\n            return (\n              <div key={p.id} className={`p-4 rounded-lg border ${isActive ? 'border-green-200 bg-green-50' : isUpcoming ? 'border-blue-200 bg-blue-50' : 'border-slate-200 bg-slate-50'}`}>\n                <div className=\"flex items-start justify-between\">\n                  <div>\n                    <div className=\"flex items-center gap-2\">\n                      <h4 className=\"font-medium text-slate-800\">{p.name}</h4>\n                      <span className={`px-2 py-0.5 rounded-full text-xs font-medium ${isActive ? 'bg-green-200 text-green-700' : isUpcoming ? 'bg-blue-200 text-blue-700' : 'bg-slate-200 text-slate-600'}`}>{isActive ? 'Active' : isUpcoming ? 'Upcoming' : 'Ended'}</span>\n                    </div>\n                    <p className=\"text-sm text-slate-600 mt-1\">{p.description}</p>\n                    <div className=\"flex items-center gap-4 mt-2 text-sm text-slate-500\">\n                      <span><Calendar className=\"w-4 h-4 inline mr-1\" />{p.startDate} - {p.endDate}</span>\n                      {p.code && (<span className=\"font-mono bg-slate-200 px-2 py-0.5 rounded\">{p.code}</span>)}\n                    </div>\n                  </div>\n                  <div className=\"text-right\">\n                    <p className=\"text-sm text-slate-500\">Used {p.usageCount}x</p>\n                    <p className=\"font-bold text-green-600\">${p.revenue.toLocaleString()}</p>\n                  </div>\n                </div>\n              </div>\n            );\n          })}\n        </div>\n      </div>\n    </div>\n  );\n\n  return (\n    <div className=\"space-y-4\">\n      <div className=\"flex flex-col sm:flex-row sm:items-center justify-between gap-4\">\n        <div><h1 className=\"text-2xl font-bold text-slate-800\">Marketing</h1><p className=\"text-slate-500\">Campaigns, reviews, and referrals</p></div>\n      </div>\n\n      <div className=\"bg-white rounded-xl border border-slate-200 p-1 inline-flex flex-wrap gap-1\">\n        {[{ id: 'campaigns', label: 'Campaigns', icon: <Megaphone className=\"w-4 h-4\" /> },\n          { id: 'reviews', label: 'Reviews', icon: <Star className=\"w-4 h-4\" />, badge: pendingReviews },\n          { id: 'referrals', label: 'Referrals', icon: <Users className=\"w-4 h-4\" />, badge: pendingReferrals },\n          { id: 'promotions', label: 'Promotions', icon: <Calendar className=\"w-4 h-4\" /> }\n        ].map((v) => (\n          <button key={v.id} onClick={() => setViewMode(v.id as ViewMode)} className={`px-4 py-2 rounded-lg text-sm font-medium transition-colors flex items-center gap-2 ${viewMode === v.id ? 'bg-orange-100 text-orange-700' : 'text-slate-600 hover:text-slate-800'}`}>\n            {v.icon}{v.label}{v.badge && v.badge > 0 && (<span className=\"px-1.5 py-0.5 bg-amber-500 text-white text-xs rounded-full\">{v.badge}</span>)}\n          </button>\n        ))}\n      </div>\n\n      {viewMode === 'campaigns' && <CampaignsView />}\n      {viewMode === 'reviews' && <ReviewsView />}\n      {viewMode === 'referrals' && <ReferralsView />}\n      {viewMode === 'promotions' && <PromotionsView />}\n\n      {showRespond && (\n        <div className=\"fixed inset-0 bg-black/50 flex items-center justify-center z-50\">\n          <div className=\"bg-white rounded-2xl w-full max-w-lg mx-4\">\n            <div className=\"p-4 border-b border-slate-200 flex items-center justify-between\">\n              <h3 className=\"font-semibold text-slate-800\">Respond to Review</h3>\n              <button onClick={() => setShowRespond(null)} className=\"p-2 hover:bg-slate-100 rounded-lg\"><X className=\"w-5 h-5 text-slate-600\" /></button>\n            </div>\n            <div className=\"p-4 space-y-4\">\n              <div className=\"p-4 bg-slate-50 rounded-lg\">\n                <div className=\"flex items-center gap-2 mb-2\">\n                  <span className=\"font-medium text-slate-800\">{showRespond.customerName}</span>\n                  <div className=\"flex items-center\">{[1,2,3,4,5].map((s) => (<Star key={s} className={`w-3 h-3 ${s <= showRespond.rating ? 'text-amber-400 fill-current' : 'text-slate-200'}`} />))}</div>\n                </div>\n                <p className=\"text-sm text-slate-600\">\"{showRespond.text}\"</p>\n              </div>\n              <div>\n                <label className=\"block text-sm font-medium text-slate-700 mb-1\">Your Response</label>\n                <textarea value={responseText} onChange={(e) => setResponseText(e.target.value)} rows={4} placeholder=\"Thank you for your feedback...\" className=\"w-full px-4 py-2 border border-slate-200 rounded-lg resize-none\" />\n              </div>\n              <button className=\"flex items-center gap-2 text-sm text-purple-600 hover:text-purple-700\"><Sparkles className=\"w-4 h-4\" />Generate AI response</button>\n              <div className=\"flex gap-3\">\n                <button onClick={() => setShowRespond(null)} className=\"flex-1 py-2 border border-slate-200 text-slate-700 rounded-lg hover:bg-slate-50\">Cancel</button>\n                <button onClick={handleRespond} className=\"flex-1 py-2 bg-orange-500 text-white rounded-lg hover:bg-orange-600\">Submit Response</button>\n              </div>\n            </div>\n          </div>\n        </div>\n      )}\n\n      {showCreate && (\n        <div className=\"fixed inset-0 bg-black/50 flex items-center justify-center z-50\">\n          <div className=\"bg-white rounded-2xl w-full max-w-lg mx-4\">\n            <div className=\"p-4 border-b border-slate-200 flex items-center justify-between\">\n              <h3 className=\"font-semibold text-slate-800\">Create Campaign</h3>\n              <button onClick={() => setShowCreate(false)} className=\"p-2 hover:bg-slate-100 rounded-lg\"><X className=\"w-5 h-5 text-slate-600\" /></button>\n            </div>\n            <div className=\"p-4 space-y-4\">\n              <div><label className=\"block text-sm font-medium text-slate-700 mb-1\">Campaign Name</label><input type=\"text\" placeholder=\"Summer AC Special\" className=\"w-full px-4 py-2 border border-slate-200 rounded-lg\" /></div>\n              <div className=\"grid grid-cols-2 gap-4\">\n                <div><label className=\"block text-sm font-medium text-slate-700 mb-1\">Type</label><select className=\"w-full px-4 py-2 border border-slate-200 rounded-lg\"><option>Email</option><option>Direct Mail</option><option>Digital Ads</option><option>SMS</option></select></div>\n                <div><label className=\"block text-sm font-medium text-slate-700 mb-1\">Audience</label><select className=\"w-full px-4 py-2 border border-slate-200 rounded-lg\"><option>All Customers</option><option>HVAC Customers</option><option>Plumbing Customers</option><option>Inactive 6+ months</option></select></div>\n              </div>\n              <div><label className=\"block text-sm font-medium text-slate-700 mb-1\">Start Date</label><input type=\"date\" className=\"w-full px-4 py-2 border border-slate-200 rounded-lg\" /></div>\n              <div className=\"flex gap-3\">\n                <button onClick={() => setShowCreate(false)} className=\"flex-1 py-2 border border-slate-200 text-slate-700 rounded-lg hover:bg-slate-50\">Cancel</button>\n                <button onClick={() => { setShowCreate(false); alert('Campaign created!'); }} className=\"flex-1 py-2 bg-orange-500 text-white rounded-lg hover:bg-orange-600\">Create Campaign</button>\n              </div>\n            </div>\n          </div>\n        </div>\n      )}\n    </div>\n  );\n};\n\nexport default Marketing;"
  }
}