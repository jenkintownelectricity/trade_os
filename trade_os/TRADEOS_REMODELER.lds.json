{
  "_lds": {
    "uuid": "tradeos-remodeler-2026-001",
    "type": "ui_component",
    "version": "1.0.0",
    "created": "2026-01-14T04:30:00Z",
    "parent": "tradeos-master-2026-001",
    "phase": 6,
    "sequence": 3
  },
  "core": {
    "name": "TradeOS Remodeler",
    "description": "Builder and remodeler features for project management, change orders, and subcontractor coordination.",
    "principle": "Admin can project:delete. Office can project:create, change_order:create. Customer can view:project_progress."
  },
  "features": {
    "project_phases": "Track project phases with milestones",
    "change_orders": "Manage change orders with approvals",
    "photo_timeline": "Photo documentation throughout project",
    "subcontractors": "Assign and track subcontractors",
    "selections": "Track customer selections (finishes, fixtures)",
    "draw_schedule": "Payment milestones tied to progress",
    "punch_list": "Final punch list management"
  },
  "react_component": {
    "filename": "Remodeler.tsx",
    "code": "import React, { useState, useCallback } from 'react';\nimport { Building, Layers, FileText, Camera, Users, CheckSquare, DollarSign, Plus, X, ChevronRight, ChevronDown, Clock, CheckCircle2, AlertTriangle, Edit, Calendar, Image, Wrench } from 'lucide-react';\nimport { useKernel } from './LDSKernel';\n\ntype ProjectStatus = 'planning' | 'in_progress' | 'on_hold' | 'completed';\ntype PhaseStatus = 'pending' | 'in_progress' | 'completed';\ntype ChangeOrderStatus = 'pending' | 'approved' | 'denied';\ntype SelectionStatus = 'pending' | 'selected' | 'ordered' | 'installed';\ntype DrawStatus = 'pending' | 'invoiced' | 'paid';\ntype PunchStatus = 'open' | 'in_progress' | 'completed';\n\ninterface Phase { id: string; name: string; order: number; status: PhaseStatus; startDate?: string; endDate?: string; percentComplete: number; }\ninterface ChangeOrder { id: string; number: string; description: string; amount: number; status: ChangeOrderStatus; createdDate: string; approvedDate?: string; approvedBy?: string; reason: string; }\ninterface Photo { id: string; url: string; caption: string; date: string; phase: string; uploadedBy: string; }\ninterface Subcontractor { id: string; name: string; trade: string; phone: string; email: string; status: 'active' | 'scheduled' | 'completed'; assignedPhases: string[]; }\ninterface Selection { id: string; category: string; item: string; vendor?: string; price?: number; status: SelectionStatus; selectedDate?: string; notes?: string; }\ninterface Draw { id: string; number: number; description: string; amount: number; percentOfTotal: number; phase: string; status: DrawStatus; dueDate: string; paidDate?: string; }\ninterface PunchItem { id: string; description: string; location: string; assignedTo: string; status: PunchStatus; createdDate: string; completedDate?: string; priority: 'low' | 'medium' | 'high'; }\n\ninterface Project { id: string; name: string; customerName: string; address: string; status: ProjectStatus; startDate: string; estimatedEnd: string; contractValue: number; changeOrderTotal: number; phases: Phase[]; changeOrders: ChangeOrder[]; photos: Photo[]; subcontractors: Subcontractor[]; selections: Selection[]; draws: Draw[]; punchList: PunchItem[]; }\n\nconst PROJECT: Project = {\n  id: 'proj-1', name: 'Johnson Kitchen & Bath Remodel', customerName: 'Johnson Family', address: '123 Oak St, Philadelphia, PA', status: 'in_progress', startDate: '2025-11-15', estimatedEnd: '2026-03-15', contractValue: 85000, changeOrderTotal: 4500,\n  phases: [\n    { id: 'ph-1', name: 'Demo & Rough-In', order: 1, status: 'completed', startDate: '2025-11-15', endDate: '2025-12-01', percentComplete: 100 },\n    { id: 'ph-2', name: 'Plumbing Rough', order: 2, status: 'completed', startDate: '2025-12-02', endDate: '2025-12-15', percentComplete: 100 },\n    { id: 'ph-3', name: 'Electrical Rough', order: 3, status: 'completed', startDate: '2025-12-10', endDate: '2025-12-20', percentComplete: 100 },\n    { id: 'ph-4', name: 'Drywall & Paint', order: 4, status: 'in_progress', startDate: '2026-01-06', percentComplete: 60 },\n    { id: 'ph-5', name: 'Cabinetry Install', order: 5, status: 'pending', percentComplete: 0 },\n    { id: 'ph-6', name: 'Countertops', order: 6, status: 'pending', percentComplete: 0 },\n    { id: 'ph-7', name: 'Fixtures & Finish', order: 7, status: 'pending', percentComplete: 0 },\n    { id: 'ph-8', name: 'Final Inspection', order: 8, status: 'pending', percentComplete: 0 }\n  ],\n  changeOrders: [\n    { id: 'co-1', number: 'CO-001', description: 'Upgrade to quartz countertops', amount: 3200, status: 'approved', createdDate: '2025-12-10', approvedDate: '2025-12-12', approvedBy: 'Johnson', reason: 'Customer request' },\n    { id: 'co-2', number: 'CO-002', description: 'Add under-cabinet lighting', amount: 850, status: 'approved', createdDate: '2025-12-18', approvedDate: '2025-12-20', approvedBy: 'Johnson', reason: 'Design enhancement' },\n    { id: 'co-3', number: 'CO-003', description: 'Move electrical outlet location', amount: 450, status: 'pending', createdDate: '2026-01-10', reason: 'Appliance change' }\n  ],\n  photos: [\n    { id: 'img-1', url: '/demo-1.jpg', caption: 'Kitchen demo complete', date: '2025-11-20', phase: 'Demo & Rough-In', uploadedBy: 'Mike Johnson' },\n    { id: 'img-2', url: '/plumb-1.jpg', caption: 'Plumbing rough-in', date: '2025-12-08', phase: 'Plumbing Rough', uploadedBy: 'James Martinez' },\n    { id: 'img-3', url: '/elec-1.jpg', caption: 'Electrical panel upgrade', date: '2025-12-15', phase: 'Electrical Rough', uploadedBy: 'David Brown' },\n    { id: 'img-4', url: '/drywall-1.jpg', caption: 'Drywall installation', date: '2026-01-10', phase: 'Drywall & Paint', uploadedBy: 'Mike Johnson' }\n  ],\n  subcontractors: [\n    { id: 'sub-1', name: 'Elite Plumbing', trade: 'Plumbing', phone: '(215) 555-0301', email: 'elite@plumbing.com', status: 'completed', assignedPhases: ['Plumbing Rough', 'Fixtures & Finish'] },\n    { id: 'sub-2', name: 'Volt Electric', trade: 'Electrical', phone: '(215) 555-0302', email: 'info@voltelectric.com', status: 'completed', assignedPhases: ['Electrical Rough', 'Fixtures & Finish'] },\n    { id: 'sub-3', name: 'Premier Drywall', trade: 'Drywall', phone: '(215) 555-0303', email: 'premier@drywall.com', status: 'active', assignedPhases: ['Drywall & Paint'] },\n    { id: 'sub-4', name: 'Custom Cabinets Inc', trade: 'Cabinetry', phone: '(215) 555-0304', email: 'orders@customcab.com', status: 'scheduled', assignedPhases: ['Cabinetry Install'] },\n    { id: 'sub-5', name: 'Stone Masters', trade: 'Countertops', phone: '(215) 555-0305', email: 'sales@stonemasters.com', status: 'scheduled', assignedPhases: ['Countertops'] }\n  ],\n  selections: [\n    { id: 'sel-1', category: 'Countertops', item: 'Calacatta Quartz', vendor: 'Stone Masters', price: 4800, status: 'ordered', selectedDate: '2025-12-15' },\n    { id: 'sel-2', category: 'Cabinets', item: 'Shaker White - Maple', vendor: 'Custom Cabinets', price: 12500, status: 'ordered', selectedDate: '2025-11-28' },\n    { id: 'sel-3', category: 'Sink', item: 'Kohler Undermount SS', vendor: 'Ferguson', price: 450, status: 'selected', selectedDate: '2025-12-20' },\n    { id: 'sel-4', category: 'Faucet', item: 'Delta Trinsic', vendor: 'Ferguson', price: 380, status: 'selected', selectedDate: '2025-12-20' },\n    { id: 'sel-5', category: 'Lighting', item: 'Pendant - Brushed Nickel', vendor: 'Lighting Plus', price: 650, status: 'pending', notes: 'Awaiting customer decision' },\n    { id: 'sel-6', category: 'Paint', item: 'SW Agreeable Gray', vendor: 'Sherwin Williams', price: 180, status: 'installed', selectedDate: '2025-12-28' },\n    { id: 'sel-7', category: 'Flooring', item: 'LVP - Natural Oak', vendor: 'Floor & Decor', price: 2200, status: 'ordered', selectedDate: '2026-01-05' }\n  ],\n  draws: [\n    { id: 'dr-1', number: 1, description: 'Contract Deposit', amount: 17000, percentOfTotal: 20, phase: 'Contract Signing', status: 'paid', dueDate: '2025-11-10', paidDate: '2025-11-10' },\n    { id: 'dr-2', number: 2, description: 'Demo & Rough Complete', amount: 21250, percentOfTotal: 25, phase: 'Demo & Rough-In', status: 'paid', dueDate: '2025-12-05', paidDate: '2025-12-06' },\n    { id: 'dr-3', number: 3, description: 'Rough-In Complete', amount: 21250, percentOfTotal: 25, phase: 'Electrical Rough', status: 'paid', dueDate: '2025-12-22', paidDate: '2025-12-23' },\n    { id: 'dr-4', number: 4, description: 'Cabinetry & Counters', amount: 17000, percentOfTotal: 20, phase: 'Countertops', status: 'pending', dueDate: '2026-02-15' },\n    { id: 'dr-5', number: 5, description: 'Final Payment', amount: 8500, percentOfTotal: 10, phase: 'Final Inspection', status: 'pending', dueDate: '2026-03-15' }\n  ],\n  punchList: [\n    { id: 'pn-1', description: 'Touch up paint near window', location: 'Kitchen - North Wall', assignedTo: 'Mike Johnson', status: 'open', createdDate: '2026-01-12', priority: 'low' },\n    { id: 'pn-2', description: 'Adjust cabinet door alignment', location: 'Kitchen - Upper Cabinets', assignedTo: 'Custom Cabinets', status: 'open', createdDate: '2026-01-12', priority: 'medium' },\n    { id: 'pn-3', description: 'Caulk around countertop edge', location: 'Kitchen - Countertop', assignedTo: 'Stone Masters', status: 'open', createdDate: '2026-01-12', priority: 'medium' }\n  ]\n};\n\nconst STATUS_CONF: Record<ProjectStatus, { label: string; color: string }> = { planning: { label: 'Planning', color: 'text-blue-600 bg-blue-100' }, in_progress: { label: 'In Progress', color: 'text-green-600 bg-green-100' }, on_hold: { label: 'On Hold', color: 'text-amber-600 bg-amber-100' }, completed: { label: 'Completed', color: 'text-slate-600 bg-slate-100' } };\nconst PHASE_CONF: Record<PhaseStatus, { label: string; color: string }> = { pending: { label: 'Pending', color: 'text-slate-600 bg-slate-100' }, in_progress: { label: 'In Progress', color: 'text-blue-600 bg-blue-100' }, completed: { label: 'Complete', color: 'text-green-600 bg-green-100' } };\nconst CO_CONF: Record<ChangeOrderStatus, { label: string; color: string }> = { pending: { label: 'Pending', color: 'text-amber-600 bg-amber-100' }, approved: { label: 'Approved', color: 'text-green-600 bg-green-100' }, denied: { label: 'Denied', color: 'text-red-600 bg-red-100' } };\nconst SEL_CONF: Record<SelectionStatus, { label: string; color: string }> = { pending: { label: 'Pending', color: 'text-amber-600 bg-amber-100' }, selected: { label: 'Selected', color: 'text-blue-600 bg-blue-100' }, ordered: { label: 'Ordered', color: 'text-purple-600 bg-purple-100' }, installed: { label: 'Installed', color: 'text-green-600 bg-green-100' } };\nconst DRAW_CONF: Record<DrawStatus, { label: string; color: string }> = { pending: { label: 'Pending', color: 'text-slate-600 bg-slate-100' }, invoiced: { label: 'Invoiced', color: 'text-blue-600 bg-blue-100' }, paid: { label: 'Paid', color: 'text-green-600 bg-green-100' } };\nconst PUNCH_CONF: Record<PunchStatus, { label: string; color: string }> = { open: { label: 'Open', color: 'text-red-600 bg-red-100' }, in_progress: { label: 'In Progress', color: 'text-amber-600 bg-amber-100' }, completed: { label: 'Done', color: 'text-green-600 bg-green-100' } };\n\ntype ViewMode = 'overview' | 'phases' | 'change_orders' | 'photos' | 'selections' | 'draws' | 'punch_list';\n\nexport const Remodeler: React.FC = () => {\n  const { validate, role } = useKernel();\n  const [viewMode, setViewMode] = useState<ViewMode>('overview');\n  const [project, setProject] = useState<Project>(PROJECT);\n  const [showAddCO, setShowAddCO] = useState(false);\n  const [showAddPunch, setShowAddPunch] = useState(false);\n\n  const handleApproveCO = useCallback((coId: string) => {\n    const r = validate('change_order:approve', { authenticated: true });\n    if (r.result !== 'ALLOWED') { alert(`Denied: ${r.reason}`); return; }\n    setProject(prev => ({ ...prev, changeOrders: prev.changeOrders.map(co => co.id === coId ? { ...co, status: 'approved' as ChangeOrderStatus, approvedDate: new Date().toISOString().split('T')[0], approvedBy: 'Admin' } : co), changeOrderTotal: prev.changeOrderTotal + (prev.changeOrders.find(c => c.id === coId)?.amount || 0) }));\n    alert('Change Order Approved!');\n  }, [validate]);\n\n  const handleCompletePunch = useCallback((pId: string) => {\n    setProject(prev => ({ ...prev, punchList: prev.punchList.map(p => p.id === pId ? { ...p, status: 'completed' as PunchStatus, completedDate: new Date().toISOString().split('T')[0] } : p) }));\n  }, []);\n\n  const totalContract = project.contractValue + project.changeOrderTotal;\n  const paidAmount = project.draws.filter(d => d.status === 'paid').reduce((s, d) => s + d.amount, 0);\n  const overallProgress = Math.round(project.phases.reduce((s, p) => s + p.percentComplete, 0) / project.phases.length);\n  const openPunch = project.punchList.filter(p => p.status !== 'completed').length;\n  const pendingCOs = project.changeOrders.filter(co => co.status === 'pending').length;\n\n  const OverviewView = () => (<div className=\"space-y-6\">\n    <div className=\"grid grid-cols-2 md:grid-cols-4 gap-4\">\n      <div className=\"bg-white rounded-xl border border-slate-200 p-4\"><p className=\"text-sm text-slate-500\">Contract Total</p><p className=\"text-2xl font-bold text-slate-800\">${totalContract.toLocaleString()}</p></div>\n      <div className=\"bg-white rounded-xl border border-green-200 p-4\"><p className=\"text-sm text-green-600\">Amount Paid</p><p className=\"text-2xl font-bold text-green-600\">${paidAmount.toLocaleString()}</p></div>\n      <div className=\"bg-white rounded-xl border border-slate-200 p-4\"><p className=\"text-sm text-slate-500\">Overall Progress</p><p className=\"text-2xl font-bold text-slate-800\">{overallProgress}%</p></div>\n      <div className=\"bg-white rounded-xl border border-amber-200 p-4\"><p className=\"text-sm text-amber-600\">Change Orders</p><p className=\"text-2xl font-bold text-amber-600\">${project.changeOrderTotal.toLocaleString()}</p></div>\n    </div>\n    <div className=\"bg-white rounded-xl border border-slate-200 p-6\"><div className=\"flex items-start justify-between mb-4\"><div><h2 className=\"text-xl font-bold text-slate-800\">{project.name}</h2><p className=\"text-slate-500\">{project.customerName} • {project.address}</p></div><span className={`px-3 py-1 rounded-full text-sm font-medium ${STATUS_CONF[project.status].color}`}>{STATUS_CONF[project.status].label}</span></div>\n      <div className=\"grid grid-cols-2 md:grid-cols-4 gap-4 mb-6\"><div className=\"p-3 bg-slate-50 rounded-lg\"><p className=\"text-sm text-slate-500\">Start Date</p><p className=\"font-medium text-slate-800\">{project.startDate}</p></div><div className=\"p-3 bg-slate-50 rounded-lg\"><p className=\"text-sm text-slate-500\">Est. Completion</p><p className=\"font-medium text-slate-800\">{project.estimatedEnd}</p></div><div className=\"p-3 bg-slate-50 rounded-lg\"><p className=\"text-sm text-slate-500\">Phases Complete</p><p className=\"font-medium text-slate-800\">{project.phases.filter(p => p.status === 'completed').length}/{project.phases.length}</p></div><div className=\"p-3 bg-slate-50 rounded-lg\"><p className=\"text-sm text-slate-500\">Open Punch Items</p><p className=\"font-medium text-slate-800\">{openPunch}</p></div></div>\n      <div><h3 className=\"font-semibold text-slate-800 mb-3\">Phase Progress</h3><div className=\"space-y-2\">{project.phases.map(ph => (<div key={ph.id} className=\"flex items-center gap-4\"><div className=\"w-32 text-sm text-slate-700 truncate\">{ph.name}</div><div className=\"flex-1 h-3 bg-slate-100 rounded-full overflow-hidden\"><div className={`h-full rounded-full ${ph.status === 'completed' ? 'bg-green-500' : ph.status === 'in_progress' ? 'bg-blue-500' : 'bg-slate-300'}`} style={{ width: `${ph.percentComplete}%` }} /></div><div className=\"w-12 text-right text-sm font-medium text-slate-600\">{ph.percentComplete}%</div></div>))}</div></div>\n    </div>\n  </div>);\n\n  const PhasesView = () => (<div className=\"space-y-4\">{project.phases.map(ph => { const pc = PHASE_CONF[ph.status]; return (<div key={ph.id} className=\"bg-white rounded-xl border border-slate-200 p-4\"><div className=\"flex items-center justify-between\"><div className=\"flex items-center gap-3\"><div className={`w-8 h-8 rounded-full flex items-center justify-center ${ph.status === 'completed' ? 'bg-green-100 text-green-600' : ph.status === 'in_progress' ? 'bg-blue-100 text-blue-600' : 'bg-slate-100 text-slate-400'}`}>{ph.status === 'completed' ? <CheckCircle2 className=\"w-5 h-5\" /> : <span className=\"font-bold\">{ph.order}</span>}</div><div><p className=\"font-semibold text-slate-800\">{ph.name}</p><p className=\"text-sm text-slate-500\">{ph.startDate ? `${ph.startDate}${ph.endDate ? ` - ${ph.endDate}` : ' - ongoing'}` : 'Not started'}</p></div></div><div className=\"flex items-center gap-4\"><span className={`px-2 py-1 rounded-full text-xs font-medium ${pc.color}`}>{pc.label}</span><span className=\"font-bold text-slate-800\">{ph.percentComplete}%</span></div></div></div>); })}</div>);\n\n  const ChangeOrdersView = () => (<div className=\"space-y-6\"><div className=\"flex items-center justify-between\"><h3 className=\"font-semibold text-slate-800\">Change Orders</h3><button onClick={() => setShowAddCO(true)} className=\"px-4 py-2 bg-orange-500 text-white rounded-lg hover:bg-orange-600 flex items-center gap-2\"><Plus className=\"w-4 h-4\" /> Add CO</button></div><div className=\"space-y-4\">{project.changeOrders.map(co => { const cc = CO_CONF[co.status]; return (<div key={co.id} className=\"bg-white rounded-xl border border-slate-200 p-4\"><div className=\"flex items-start justify-between mb-2\"><div><div className=\"flex items-center gap-2\"><p className=\"font-semibold text-slate-800\">{co.number}</p><span className={`px-2 py-1 rounded-full text-xs font-medium ${cc.color}`}>{cc.label}</span></div><p className=\"text-slate-600\">{co.description}</p></div><p className=\"text-xl font-bold text-slate-800\">${co.amount.toLocaleString()}</p></div><div className=\"flex items-center justify-between text-sm\"><span className=\"text-slate-500\">Created: {co.createdDate} • Reason: {co.reason}</span>{co.status === 'pending' && role === 'admin' && (<button onClick={() => handleApproveCO(co.id)} className=\"px-3 py-1.5 bg-green-100 text-green-700 rounded-lg hover:bg-green-200 font-medium\">Approve</button>)}</div></div>); })}</div></div>);\n\n  const PhotosView = () => (<div className=\"space-y-6\"><div className=\"flex items-center justify-between\"><h3 className=\"font-semibold text-slate-800\">Photo Timeline</h3><button className=\"px-4 py-2 bg-orange-500 text-white rounded-lg hover:bg-orange-600 flex items-center gap-2\"><Camera className=\"w-4 h-4\" /> Upload Photo</button></div><div className=\"grid grid-cols-2 md:grid-cols-4 gap-4\">{project.photos.map(ph => (<div key={ph.id} className=\"bg-white rounded-xl border border-slate-200 overflow-hidden\"><div className=\"aspect-video bg-slate-200 flex items-center justify-center\"><Image className=\"w-12 h-12 text-slate-400\" /></div><div className=\"p-3\"><p className=\"font-medium text-slate-800 text-sm\">{ph.caption}</p><p className=\"text-xs text-slate-500\">{ph.phase}</p><p className=\"text-xs text-slate-400\">{ph.date} • {ph.uploadedBy}</p></div></div>))}</div></div>);\n\n  const SelectionsView = () => (<div className=\"space-y-6\"><div className=\"bg-white rounded-xl border border-slate-200 overflow-hidden\"><div className=\"p-4 border-b border-slate-100 flex items-center justify-between\"><h3 className=\"font-semibold text-slate-800\">Customer Selections</h3><button className=\"px-4 py-2 bg-orange-500 text-white rounded-lg hover:bg-orange-600 flex items-center gap-2\"><Plus className=\"w-4 h-4\" /> Add Selection</button></div><table className=\"w-full\"><thead className=\"bg-slate-50\"><tr><th className=\"px-4 py-3 text-left text-xs font-medium text-slate-500 uppercase\">Category</th><th className=\"px-4 py-3 text-left text-xs font-medium text-slate-500 uppercase\">Selection</th><th className=\"px-4 py-3 text-left text-xs font-medium text-slate-500 uppercase\">Vendor</th><th className=\"px-4 py-3 text-right text-xs font-medium text-slate-500 uppercase\">Price</th><th className=\"px-4 py-3 text-left text-xs font-medium text-slate-500 uppercase\">Status</th></tr></thead><tbody className=\"divide-y divide-slate-100\">{project.selections.map(sel => { const sc = SEL_CONF[sel.status]; return (<tr key={sel.id} className=\"hover:bg-slate-50\"><td className=\"px-4 py-4 font-medium text-slate-800\">{sel.category}</td><td className=\"px-4 py-4 text-slate-700\">{sel.item}</td><td className=\"px-4 py-4 text-slate-600\">{sel.vendor || '-'}</td><td className=\"px-4 py-4 text-right text-slate-700\">{sel.price ? `$${sel.price.toLocaleString()}` : '-'}</td><td className=\"px-4 py-4\"><span className={`px-2 py-1 rounded-full text-xs font-medium ${sc.color}`}>{sc.label}</span></td></tr>); })}</tbody></table></div></div>);\n\n  const DrawsView = () => (<div className=\"space-y-6\"><div className=\"grid grid-cols-1 md:grid-cols-3 gap-4\"><div className=\"bg-white rounded-xl border border-slate-200 p-4\"><p className=\"text-sm text-slate-500\">Contract + COs</p><p className=\"text-2xl font-bold text-slate-800\">${totalContract.toLocaleString()}</p></div><div className=\"bg-white rounded-xl border border-green-200 p-4\"><p className=\"text-sm text-green-600\">Paid</p><p className=\"text-2xl font-bold text-green-600\">${paidAmount.toLocaleString()}</p></div><div className=\"bg-white rounded-xl border border-slate-200 p-4\"><p className=\"text-sm text-slate-500\">Remaining</p><p className=\"text-2xl font-bold text-slate-800\">${(totalContract - paidAmount).toLocaleString()}</p></div></div><div className=\"space-y-3\">{project.draws.map(dr => { const dc = DRAW_CONF[dr.status]; return (<div key={dr.id} className={`bg-white rounded-xl border p-4 ${dr.status === 'paid' ? 'border-green-200' : 'border-slate-200'}`}><div className=\"flex items-center justify-between\"><div className=\"flex items-center gap-4\"><div className={`w-10 h-10 rounded-full flex items-center justify-center ${dr.status === 'paid' ? 'bg-green-100 text-green-600' : 'bg-slate-100 text-slate-600'}`}>{dr.status === 'paid' ? <CheckCircle2 className=\"w-5 h-5\" /> : <span className=\"font-bold\">{dr.number}</span>}</div><div><p className=\"font-semibold text-slate-800\">Draw #{dr.number}: {dr.description}</p><p className=\"text-sm text-slate-500\">{dr.phase} • Due: {dr.dueDate}{dr.paidDate ? ` • Paid: ${dr.paidDate}` : ''}</p></div></div><div className=\"text-right\"><p className=\"text-xl font-bold text-slate-800\">${dr.amount.toLocaleString()}</p><p className=\"text-sm text-slate-500\">{dr.percentOfTotal}% of contract</p><span className={`px-2 py-1 rounded-full text-xs font-medium ${dc.color}`}>{dc.label}</span></div></div></div>); })}</div></div>);\n\n  const PunchListView = () => (<div className=\"space-y-6\"><div className=\"flex items-center justify-between\"><h3 className=\"font-semibold text-slate-800\">Punch List ({openPunch} open)</h3><button onClick={() => setShowAddPunch(true)} className=\"px-4 py-2 bg-orange-500 text-white rounded-lg hover:bg-orange-600 flex items-center gap-2\"><Plus className=\"w-4 h-4\" /> Add Item</button></div><div className=\"space-y-3\">{project.punchList.map(pi => { const pc = PUNCH_CONF[pi.status]; return (<div key={pi.id} className={`bg-white rounded-xl border p-4 ${pi.status === 'completed' ? 'border-green-200 bg-green-50' : pi.priority === 'high' ? 'border-red-200' : 'border-slate-200'}`}><div className=\"flex items-start justify-between\"><div className=\"flex items-start gap-3\"><button onClick={() => handleCompletePunch(pi.id)} className={`mt-1 w-5 h-5 rounded border-2 flex items-center justify-center ${pi.status === 'completed' ? 'bg-green-500 border-green-500 text-white' : 'border-slate-300 hover:border-green-500'}`}>{pi.status === 'completed' && <CheckCircle2 className=\"w-4 h-4\" />}</button><div><p className={`font-medium ${pi.status === 'completed' ? 'text-slate-500 line-through' : 'text-slate-800'}`}>{pi.description}</p><p className=\"text-sm text-slate-500\">{pi.location} • Assigned: {pi.assignedTo}</p></div></div><div className=\"flex items-center gap-2\"><span className={`px-2 py-1 rounded-full text-xs font-medium ${pc.color}`}>{pc.label}</span>{pi.priority === 'high' && <span className=\"px-2 py-1 rounded-full text-xs font-medium bg-red-100 text-red-700\">High</span>}</div></div></div>); })}</div></div>);\n\n  return (\n    <div className=\"space-y-4\">\n      <div className=\"flex flex-col sm:flex-row sm:items-center justify-between gap-4\"><div><h1 className=\"text-2xl font-bold text-slate-800\">Remodeler</h1><p className=\"text-slate-500\">Project management for builders</p></div></div>\n      <div className=\"bg-white rounded-xl border border-slate-200 p-1 inline-flex flex-wrap gap-1\">{[{ id: 'overview', label: 'Overview', icon: <Building className=\"w-4 h-4\" /> }, { id: 'phases', label: 'Phases', icon: <Layers className=\"w-4 h-4\" /> }, { id: 'change_orders', label: 'Change Orders', icon: <FileText className=\"w-4 h-4\" />, badge: pendingCOs }, { id: 'photos', label: 'Photos', icon: <Camera className=\"w-4 h-4\" /> }, { id: 'selections', label: 'Selections', icon: <CheckSquare className=\"w-4 h-4\" /> }, { id: 'draws', label: 'Draws', icon: <DollarSign className=\"w-4 h-4\" /> }, { id: 'punch_list', label: 'Punch List', icon: <Wrench className=\"w-4 h-4\" />, badge: openPunch }].map((v) => (<button key={v.id} onClick={() => setViewMode(v.id as ViewMode)} className={`px-4 py-2 rounded-lg text-sm font-medium transition-colors flex items-center gap-2 ${viewMode === v.id ? 'bg-orange-100 text-orange-700' : 'text-slate-600 hover:text-slate-800'}`}>{v.icon}{v.label}{v.badge && v.badge > 0 && <span className=\"px-1.5 py-0.5 bg-amber-500 text-white text-xs rounded-full\">{v.badge}</span>}</button>))}</div>\n      {viewMode === 'overview' && <OverviewView />}\n      {viewMode === 'phases' && <PhasesView />}\n      {viewMode === 'change_orders' && <ChangeOrdersView />}\n      {viewMode === 'photos' && <PhotosView />}\n      {viewMode === 'selections' && <SelectionsView />}\n      {viewMode === 'draws' && <DrawsView />}\n      {viewMode === 'punch_list' && <PunchListView />}\n      {showAddCO && (<div className=\"fixed inset-0 bg-black/50 flex items-center justify-center z-50\"><div className=\"bg-white rounded-2xl w-full max-w-lg mx-4\"><div className=\"p-4 border-b border-slate-200 flex items-center justify-between\"><h3 className=\"font-semibold text-slate-800\">Add Change Order</h3><button onClick={() => setShowAddCO(false)} className=\"p-2 hover:bg-slate-100 rounded-lg\"><X className=\"w-5 h-5 text-slate-600\" /></button></div><div className=\"p-4 space-y-4\"><div><label className=\"block text-sm font-medium text-slate-700 mb-1\">Description</label><input type=\"text\" className=\"w-full px-4 py-2 border border-slate-200 rounded-lg\" /></div><div><label className=\"block text-sm font-medium text-slate-700 mb-1\">Amount</label><input type=\"number\" className=\"w-full px-4 py-2 border border-slate-200 rounded-lg\" /></div><div><label className=\"block text-sm font-medium text-slate-700 mb-1\">Reason</label><textarea rows={2} className=\"w-full px-4 py-2 border border-slate-200 rounded-lg resize-none\" /></div><div className=\"flex gap-3\"><button onClick={() => setShowAddCO(false)} className=\"flex-1 py-2 border border-slate-200 text-slate-700 rounded-lg hover:bg-slate-50\">Cancel</button><button onClick={() => { setShowAddCO(false); alert('CO Added!'); }} className=\"flex-1 py-2 bg-orange-500 text-white rounded-lg hover:bg-orange-600\">Add</button></div></div></div></div>)}\n      {showAddPunch && (<div className=\"fixed inset-0 bg-black/50 flex items-center justify-center z-50\"><div className=\"bg-white rounded-2xl w-full max-w-lg mx-4\"><div className=\"p-4 border-b border-slate-200 flex items-center justify-between\"><h3 className=\"font-semibold text-slate-800\">Add Punch Item</h3><button onClick={() => setShowAddPunch(false)} className=\"p-2 hover:bg-slate-100 rounded-lg\"><X className=\"w-5 h-5 text-slate-600\" /></button></div><div className=\"p-4 space-y-4\"><div><label className=\"block text-sm font-medium text-slate-700 mb-1\">Description</label><input type=\"text\" className=\"w-full px-4 py-2 border border-slate-200 rounded-lg\" /></div><div><label className=\"block text-sm font-medium text-slate-700 mb-1\">Location</label><input type=\"text\" className=\"w-full px-4 py-2 border border-slate-200 rounded-lg\" /></div><div className=\"grid grid-cols-2 gap-4\"><div><label className=\"block text-sm font-medium text-slate-700 mb-1\">Assigned To</label><select className=\"w-full px-4 py-2 border border-slate-200 rounded-lg\"><option>Mike Johnson</option><option>Custom Cabinets</option><option>Stone Masters</option></select></div><div><label className=\"block text-sm font-medium text-slate-700 mb-1\">Priority</label><select className=\"w-full px-4 py-2 border border-slate-200 rounded-lg\"><option>Low</option><option>Medium</option><option>High</option></select></div></div><div className=\"flex gap-3\"><button onClick={() => setShowAddPunch(false)} className=\"flex-1 py-2 border border-slate-200 text-slate-700 rounded-lg hover:bg-slate-50\">Cancel</button><button onClick={() => { setShowAddPunch(false); alert('Added!'); }} className=\"flex-1 py-2 bg-orange-500 text-white rounded-lg hover:bg-orange-600\">Add</button></div></div></div></div>)}\n    </div>\n  );\n};\n\nexport default Remodeler;"
  }
}